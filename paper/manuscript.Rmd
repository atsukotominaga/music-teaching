---
title             : "The sound of teaching music: Expert pianists' performance modulations for novices"
shorttitle        : "The sound of teaching music"

author: 
  - name          : "Atsuko Tominaga"
    affiliation   : "1,*"
    # corresponding : yes    # Define only one corresponding author
    # address       : "Quellenstraße 51, 1100 Vienna, Austria"
    # email         : "Tominaga_Atsuko@phd.ceu.edu"
    
  - name          : "Günther Knoblich"
    affiliation   : "1"
    
  - name          : "Natalie Sebanz"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Department of Cognitive Science, Central European University, Quellenstraße 51, 1100 Vienna, Austria"
  - id            : "*"
    institution   : "Corresponding author: Tominaga_Atsuko@phd.ceu.edu"

abstract: |
  Experts modulate their performance of actions for teaching purposes, performing slower and exaggerated movements when demonstrating novel actions to novices. The present study asked whether such modulations also occur during teaching performance of a music instrument, where subtle movement modulations are crucial for achieving artistic expression. While exaggerating performances of goal-directed actions outside of artistic contexts may be straightforward, it is an open question whether and how exaggeration for the purpose of teaching operates for actions that are expressive even when performed outside of a teaching context. Pianists were asked to demonstrate to students the techniques required for implementing notated expressions, compared to performing the piece without didactic intentions. Expressions in the piece concerned either articulation (i.e., legato and staccato) or dynamics (i.e., forte and piano). The pianists played either with the goal to perform the piece to an audience or with the goal to teach the respective techniques to novices. When intending to teach articulation, skilled pianists produced more exaggerated staccato. When intending to teach dynamics, they created a larger contrast between forte and piano. We found consistent results across a simple musical scale (Experiment 1) and a more naturalistic piece of music (Experiment 2). These findings show that teaching-specific action modulations generalize to expressive actions and suggest that action modulations serve to highlight the most relevant aspects of the actions to be learnt.
  
keywords          : "teaching, skill transmission, sensorimotor communication, artistic expression, music"
#wordcount         : ""

bibliography      : ["reference.bib"]
csl: nature.csl

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

output: papaja::apa6_word
# output:
#   papaja::apa6_pdf:
#     latex_engine: xelatex
---

```{r set-up, include = FALSE}
if (!require("papaja")) {install.packages("papaja"): require("papaja")}
if (!require("here")) {install.packages("here"): require("here")}
if (!require("magick")) {install.packages("magick"): require("magick")}

# create image folder
if (!file.exists(here("paper/image"))){
  dir.create(here("paper/image"))
}
if (!file.exists(here("paper/figure"))){
  dir.create(here("paper/figure"))
}
```

# Introduction

Deliberate teaching has supported human skill transmission over generations and provides a key route for learning [@thornton_2008; @tomasello_2016]. Experts modulate their behaviour so that novices can extract relevant information to learn a novel skill. For instance, adults modulate their speech (motherese) and actions (motionese) when demonstrating a skill to infant learners [@brand_2002; @saint-georges_2013]. These modulations include slowing down and exaggerating sounds and actions. Similar findings were obtained in studies with adult learners, where exaggerations were observed when native British English speakers were talking to first language English learners [@uther_2007] and when skilled adults were teaching xylophone melodies to novices [@mcellin_2017]. The observed modulations are thought to provide communicative signals that can facilitate learning by affecting attention and memory [@csibra_2009].

Previous research has shown that demonstrators not only adjust their gestures [@campisi_2013] and actions [@fukuyama_2015] to learners' skills but engage in specific action modulations to highlight certain aspects of demonstrated actions. For example, Schaik and colleagues [@schaik_2019] showed that adults used specific action modulations for demonstrating different action effects of objects to infants. Ho and colleagues [@NIPS2016_6413] found that demonstrators chose costly movement paths at structurally important points to disambiguate one goal over other possibilities.

Performing actions with exaggeration is straightforward for actions that are normally performed in the most efficient way possible [@pezzulo_2013]. However, how can particular aspects of actions be highlighted when the actions themselves are expressive even outside of a teaching context? This is the case in music performance, where pieces are played with expression. Expressivity is a vital component of performance and typically the main focus of music teaching [@laukka_2004]. Expressive skills are generally considered to be separate from technical skills, however, fine motor control is required to implement subtle sound modulations in expressive performance [@sloboda_2000]. In some music genres such as Western classical music, it is crucial to acquire the motor skills needed to perform a piece expressively. For example, pianists translate their own interpretations of music and convey their emotions by modulating specific parameters such as timing, smoothness and loudness of sound. This raises the question of whether and how musicians modulate their actions during didactic demonstration of expressive techniques.

In naturalistic teaching settings, teachers have many possibilities for how to convey to a learner how to play a piece expressively. They may use verbal communication [@woody_2000; @woody_2006] and non-verbal bodily cues [@simones_2015] as well as modulating the sounds that they are producing. In the present study, we focused entirely on the teaching of expressive techniques through sound in order to determine whether expert musicians would systematically exaggerate the actions necessary to implement a particular technique for musical expression. Pianists were asked to perform a piece to demonstrate to a learner how to implement the notated expressions (teaching condition) and to play the same piece for an audience (performing condition). Two basic expressive techniques in piano performance were used: articulation (legato and staccato) and dynamics (forte and piano). Articulation was assessed by key-overlap time between two consecutive notes. Positive key-overlap time indicates legato styles whereas negative key-overlap time indicates staccato styles. Dynamics was evaluated by key velocity of each key press. Higher key velocity means forte styles while lower key velocity means piano styles.

If experts rely on generic action modulations, it can be expected that they will play more slowly during didactic demonstration, regardless of the kind of techniques to be taught. To the extent that experts use action modulations to support their teaching of specific techniques, they should exaggerate legato (i.e., key-overlap time should be more positive) and staccato (i.e., key-overlap time should be more negative) when teaching articulation whereas they should exaggerate forte (i.e., key velocity should be higher) and piano (i.e., key velocity should be lower) when teaching dynamics. Furthermore, one could speculate that they might produce modulations specifically at structurally important points that best highlight the technique to be taught. Importantly, they should avoid modulating irrelevant properties of expressio (e.g., the smoothness of sound while teaching dynamics).

In Experiment 1, we employed a simple musical scale to examine whether and how skilled pianists vary their performance depending on which expressive techniques (i.e., either articulation or dynamics) they are teaching. Experiment 2 was conducted to replicate our findings from Experiment 1 with a more naturalistic piece of music.

# Experiment 1

## Materials and methods
```{r methods-1, include = FALSE}
source(here("experiment-1/analysis/demographics", "questionnaire.R"), chdir = TRUE)
source(here("experiment-1/analysis/preprocessor", "error_summary.R"), chdir = TRUE)
```

### Participants

We recruited 36 piano experts who played the piano for at least the past 10 years or were studying advanced piano performance at a music school at the time of recruitment. For data analysis, we excluded three participants due to experimental errors, and two participants because they deviated substantially from the prescribed tempo (outside 2 standard deviations from the average tempo across participants). Thirty-one participants (`r nrow(dt_included[Gender == "Female"])` female) were included in data analysis. Most participants were right-handed (left: `r nrow(dt_included[Handedness == "Left"])`, ambidextrous: `r nrow(dt_included[Handedness == "Both"])`) with a mean age of `r round(mean(dt_included$Age), 2)` (*SD* = `r round(sd(dt_included$Age), 2)`). They had `r round(mean(dt_included$PianoTotalPractice), 2)` years of practice on average (*SD* = `r round(sd(dt_included$PianoTotalPractice), 2)`). `r nrow(dt_included[TeachingPiano == "Yes"])` participants had an experience in teaching the piano (*M* = `r round( mean(dt_included[TeachingPiano == "Yes"]$TeachingPianoYears), 2)` years, *SD* = `r round( sd(dt_included[TeachingPiano == "Yes"]$TeachingPianoYears), 2)`). All participants gave their informed consent before the experiment started and received vouchers for their participation. The study (No. 2018-124) was approved by the United Ethical Review Committee for Research in Psychology (EPKEB) in Hungary.

### Apparatus and stimuli

A weighted Yamaha MIDI digital piano was used to record participants' performance via Max/MSP ([https://cycling74.com/products/max](https://cycling74.com/products/max)) on a MacBook Pro with Mac OS X Mojave 10.14.3. The laptop and piano were connected to a high-fidelity soundcard (Focusrite Scarlett 6i6) to deliver a metronome and piano sound. All auditory feedback was given to participants through headphones (Audio-Technica ATH-M50X). Sheet music was displayed on a computer monitor in front of the participants. The pitch, onset and offset time of each note, and key velocity profiles were obtained from MIDI data using Max/MSP patchers.

One musical excerpt was used as a stimulus. The excerpt was taken from ``A Dozen a Day - Play with Ease in Many Keys" by Edna-Mae Burnam and modified for the experiment. It consisted of a 6-measure isochronous melody noted in 4/4 meter. The stimulus was composed in C major to be played with the right hand only. Original sheet music (i.e., sheet music without expressive notations, *Fig \ref{fig:stimuli} A*) was used for the purpose of practice. Expressive notations were added to the original sheet music for the experiment. They referred to either articulation or dynamics (*Fig \ref{fig:stimuli} B-C*). Articulation was notated as either legato or staccato. Legato indicates that musical notes are to be connected and should sound smooth. Staccato requires producing musical notes with shortened duration, keeping them separate from each other. Dynamics was notated as either forte or piano. Forte indicates that musical notes should be played loudly whereas piano indicates that musical notes should be played softly. The notation did not include any indication of fingering (i.e., the positioning of the fingers when playing the piano) because the piece was simple and pilot testing had shown that specifying fingering was not necessary.

### Procedure

First, participants were allocated to either the teaching or performing condition and asked to practise the excerpt with the notated expression of either articulation or dynamics (*Fig \ref{fig:stimuli} B-C*). As soon as they had produced the excerpt with the notated expression without pitch errors twice consecutively, the test trials began.

In the teaching condition, participants were instructed to play the excerpt of music as if they were teaching it to students. It was mentioned that the students already knew the sequence of the tones and that they were trying to learn how to perform the piece with the notated expression by listening to the participant's performance. In the performing condition, participants were asked to play the excerpt of music as if they were performing it to an audience (see details in *[Supplementary material](#supplementary)*). Participants played the piece 8 times per technique per condition, so there were 32 trials in total (2 conditions x 2 techniques x 8 trials). The order of the conditions was blocked and counterbalanced across participants. The order of the techniques within each condition was also blocked and counterbalanced across participants. A leading metronome (80 quarter beats per minute, 8 beats) indicated the target tempo before each trial.

At the end of the experiment, participants filled in a questionnaire asking about their demographic information and experience in piano performance/teaching.

### Data analysis

Three dependent variables were computed for data analysis. Inter-onset intervals (IOIs) are the intervals between onsets of adjacent notes and provide a measure of tempo. Key-overlap time (KOT) is the difference between the offset time of the current tone (i.e., key release time) and the onset time of the ensuing tone and is a measure for the smoothness of musical sequences [@bresin_2000]. A positive value indicates smooth legato styles due to overlap between the current and ensuing tone whereas a negative value indicates sharp staccato styles due to separation between the current and ensuing tone. Tone intensity is assessed by key velocity (KV) and measures the loudness of a musical note. A higher value indicates forte styles whereas a lower value indicates piano styles. The value of KV in MIDI varies between 0 (minimum) and 127 (maximum).

Data cleaning, preprocessing and statistical analysis were performed in R version 4.0.5. For statistical analysis, only 16th notes with expressive notations were included. Overall, five trials were excluded from data analysis because participants did not follow the sheet music or stopped performing before the end. Pitch errors were identified by comparing the sequence of musical notes produced by a participant with the sequence of musical notes according to the sheet music. Pitch errors included either extra, missing or substituted tones and were manually removed by using the *editData* R package. For onsets, `r round(sum(error_onset_summary$N)/((31*4*8)-5)*100, 2)`% of the trials contained at least one pitch error (extra notes: `r round(error_onset_summary[Reason == "Extra Notes"]$N/((31*4*8)-5)*100, 2)`%, missing notes: `r round(error_onset_summary[Reason == "Missing Notes"]$N/((31*4*8)-5)*100, 2)`%, substituted notes: `r round(error_onset_summary[Reason == "Substituted"]$N/((31*4*8)-5)*100, 2)`%). For offsets, `r round(sum(error_offset_summary$N)/((31*4*8)-5)*100, 2)`% of the trials contained at least one pitch error (extra notes: `r round(error_offset_summary[Reason == "Extra Notes"]$N/((31*4*8)-5)*100, 2)`%, missing notes: `r round(error_offset_summary[Reason == "Missing Notes"]$N/((31*4*8)-5)*100, 2)`%, substituted notes: `r round(error_offset_summary[Reason == "Substituted"]$N/((31*4*8)-5)*100, 2)`%). We found that some participants did not precisely follow the sheet music (e.g., they held some notes longer than notated), therefore the order of offsets did not correspond to that of onsets. We counted these as errors and removed the erroneous notes even if the order of onsets was correct. As a result, less than 1 % of total responses were corrected. In addition to pitch errors, we removed outliers for IOIs, KOT and KV, defined as values more than 3 standard deviations from the mean of each dependent variable. For each dependent variable, this resulted in less than 5% of overall responses being removed as outliers. 

We performed separate analyses for the two techniques (i.e., articulation and dynamics). A paired-sample *t*-test or a Wilcoxon Signed-rank test (a non-parametric alternative to a paired *t*-test) was performed to compare the mean IOIs in the teaching and performing condition. For KOT and KV, we performed a 2 x 2 repeated-measures analysis of variance (ANOVA) with the factors Condition (teaching vs. performing) and Subcomponent (Articulation: legato vs. staccato or Dynamics: forte vs. piano, respectively). The *t.test* or *wilcox.test* function in the *stats* R package was used for a *t*-test or a Wilcoxon Signed-rank test. For calculating an effect size, we used the *rstatix* R package. The *aov_car* function in the *afex* R package was used for a repeated-measures ANOVA. For post-hoc comparisons on the estimated marginal means, we used the *emmeans* R package. 

```{r stim-1, out.width = "100%", fig.cap = "\\label{fig:stimuli}(A)Original sheet music. (B)Articulation. The curved line (slur) indicates legato and the dots indicate staccato. (C)Dynamics. The symbol `f' denotes forte and the symbol `p' denotes piano. For data analysis, only the 16th notes were included.", echo = FALSE}
stim_a <- image_border(image_read(here("paper/sheetmusic/1", "stim_a.png")), "#FFFFFF", "140x140")
stim_d <- image_border(image_read(here("paper/sheetmusic/1", "stim_d.png")), "#FFFFFF", "140x140")
stim_n <- image_border(image_read(here("paper/sheetmusic/1", "stim_n.png")), "#FFFFFF", "140x140")

# combine
img_stimuli <- image_append(c(stim_n, stim_a, stim_d), stack = TRUE)
img_stimuli <- image_annotate(img_stimuli, "(A)", size = 80, location = "+120+70", color = "black", font = "helvetica")
img_stimuli <- image_annotate(img_stimuli, "(B)", size = 80, location = "+120+810", color = "black", font = "helvetica")
img_stimuli <- image_annotate(img_stimuli, "(C)", size = 80, location = "+120+1570", color = "black", font = "helvetica")
img_stimuli

# save
img_stimuli <- image_scale(img_stimuli, "2200")
image_write(img_stimuli, path = here("paper/figure", "Fig1.tiff"), format = "tiff")
```

\newpage

## Results

```{r results-1, include = FALSE}
source(here("experiment-1/analysis/stats", "ioi.R"), chdir = TRUE)
source(here("experiment-1/analysis/stats", "articulation.R"), chdir = TRUE)
source(here("experiment-1/analysis/stats", "dynamics.R"), chdir = TRUE)
```

All effects are reported as significant at *p* < .05. We first report results for performance of the piece with the notated expression of articulation (*Fig \ref{fig:stimuli} B*), followed by performance of the piece with the notated expression of dynamics (*Fig \ref{fig:stimuli} C*). To recall our predictions, if participants play more slowly when they are trying to teach, inter-onset intervals (IOIs) should be larger when teaching. If participants specifically modulate relevant aspects of the techniques they are trying to teach, key-overlap time (KOT) should be more positive for legato and more negative for staccato when teaching articulation, and key velocity (KV) should be higher for forte and lower for piano when teaching dynamics.

## Articulation
### Inter-onset Intervals (IOIs)

To compare the mean IOIs between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_art_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_norm$p.value))}`). The Wilcoxon Signed-rank test revealed that participants played more slowly in the teaching condition [*Mdn* = `r ioi_art_all[Condition == "teaching"]$Median` (ms), *IQR* = `r ioi_art_all[Condition == "teaching"]$IQR`] than in the performing condition [*Mdn* = `r ioi_art_all[Condition == "performing"]$Median` (ms), *IQR* = `r ioi_art_all[Condition == "performing"]$IQR`] while playing the piece with the notated articulation (*p* `r if(ioi_art_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_art$effsize, 2)`, two-tailed, *Fig \ref{fig:ioi-1}*).

```{r ioi-art-1, include = FALSE}
ioi_art_1 <- ggpaired(ioi_art_plot, cond1 = "performing", cond2 = "teaching", color = "condition", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "IOIs (ms)", title = "IOIs: Articulation") +
  ylim(150, 260) +
  geom_hline(yintercept = 188, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 230, paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_art_1.png"), plot = ioi_art_1, dpi = 300, width = 5, height = 5)
img_ioi_art_1 <- image_read(here("paper/image", "ioi_art_1.png"), density = 300)
```

### Key-Overlap Time (KOT)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Articulation (legato vs. staccato) revealed that there was a significant main effect of Articulation (*F*(`r kot_art_aov$anova_table[2,1]`,`r kot_art_aov$anova_table[2,2]`) = `r sprintf('%.0f', kot_art_aov$anova_table[2,4])`, *p* `r if(kot_art_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kot_art_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', kot_art_aov$anova_table[2,5])`) and a significant interaction between Condition and Articulation (*F*(`r kot_art_aov$anova_table[3,1]`,`r kot_art_aov$anova_table[3,2]`) = `r sprintf('%.2f', kot_art_aov$anova_table[3,4])`, *p* `r if(kot_art_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kot_art_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', kot_art_aov$anova_table[3,5])`, *Fig \ref{fig:kot-1}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment showed that for staccato KOT was more negative in the teaching condition [*M* = `r kot_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$Mean` (ms), *SD* = `r kot_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$SD`] than in the performing condition [*M* = `r kot_art_all[Condition == "performing" & Subcomponent == "Staccato"]$Mean` (ms), *SD* = `r kot_art_all[Condition == "performing" & Subcomponent == "Staccato"]$SD`] (*p* = `r sprintf('%.3f', kot_art_posthoc$p.value[2])`). For legato there was no significant difference in KOT between the teaching [*M* = `r kot_art_all[Condition == "teaching" & Subcomponent == "Legato"]$Mean` (ms), *SD* = `r kot_art_all[Condition == "teaching" & Subcomponent == "Legato"]$SD`] and performing condition [*M* = `r kot_art_all[Condition == "performing" & Subcomponent == "Legato"]$Mean` (ms), *SD* = `r kot_art_all[Condition == "performing" & Subcomponent == "Legato"]$SD`] (*p* = `r sprintf('%.2f', kot_art_posthoc$p.value[1])`).  

```{r kot-art-1, include = FALSE}
kot_art_1 <- ggpaired(kot_art_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KOT (ms)", title = "KOT: Articulation") +
  ylim(-170, 105) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.45, label.y = -50, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "kot_art_1.png"), plot = kot_art_1, dpi = 300, width = 7, height = 5)
img_kot_art_1 <- image_read(here("paper/image", "kot_art_1.png"), density = 300)
```

### Key Velocity (KV)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Articulation (legato vs. staccato) showed that there was a significant interaction between Condition and Articulation (*F*(`r vel_art_aov$anova_table[3,1]`,`r vel_art_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_art_aov$anova_table[3,4])`, *p* `r if(vel_art_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_art_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_art_aov$anova_table[3,5])`, *Fig \ref{fig:vel-1}*). However, post-hoc comparisons based on the estimated marginal means with Tukey adjustment did not find a significant difference between the teaching [Legato: *M* = `r vel_art_all[Condition == "teaching" & Subcomponent == "Legato"]$Mean`, *SD* = `r vel_art_all[Condition == "teaching" & Subcomponent == "Legato"]$SD`; Staccato: *M* = `r vel_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$Mean`, *SD* = `r vel_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$SD`] and performing condition [Legato: *M* = `r vel_art_all[Condition == "performing" & Subcomponent == "Legato"]$Mean`, *SD* = `r vel_art_all[Condition == "performing" & Subcomponent == "Legato"]$SD`, Staccato: *M* = `r vel_art_all[Condition == "performing" & Subcomponent == "Staccato"]$Mean`, *SD* = `r vel_art_all[Condition == "performing" & Subcomponent == "Staccato"]$SD`] for each subcomponent (Legato: *p* = `r sprintf('%.2f', vel_art_posthoc$p.value[1])`, Staccato: *p* = `r sprintf('%.2f', vel_art_posthoc$p.value[2])`).  

```{r vel-art-1, echo = FALSE}
vel_art_1 <- ggpaired(vel_art_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KV (0-127)", title = "KV: Articulation") +
  ylim(50, 100) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 80, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_art_1.png"), plot = vel_art_1, dpi = 300, width = 7, height = 5)
img_vel_art_1 <- image_read(here("paper/image", "vel_art_1.png"), density = 300)
```

## Dynamics
### Inter-onset Intervals (IOIs)

To compare the mean IOIs between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_dyn_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_dyn_norm$p.value))}`). The Wilcoxon Signed-rank test revealed no significant difference between the teaching condition [*Mdn* = `r ioi_dyn_all[Condition == "teaching"]$Median` (ms), *IQR* = `r ioi_dyn_all[Condition == "teaching"]$IQR`] and the performing condition [*Mdn* = `r ioi_dyn_all[Condition == "performing"]$Median` (ms), *IQR* = `r ioi_dyn_all[Condition == "performing"]$IQR`] while playing the piece with the notated dynamics (*p* `r if(ioi_dyn_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_dyn$effsize, 2)`, two-tailed, *Fig \ref{fig:ioi-1}*).

```{r ioi-dyn-1, include = FALSE}
ioi_dyn_1 <- ggpaired(ioi_dyn_plot, cond1 = "performing", cond2 = "teaching", color = "condition", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "IOIs (ms)", title = "IOIs: Dynamics") +
  ylim(150, 260) +
  geom_hline(yintercept = 188, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 200, paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_dyn_1.png"), plot = ioi_dyn_1, dpi = 300, width = 5, height = 5)
img_ioi_dyn_1 <- image_read(here("paper/image", "ioi_dyn_1.png"), density = 300)
```

### Key Velocity (KV)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Dynamics (forte vs. piano) showed that there was a significant main effect of Dynamics (*F*(`r vel_dyn_aov$anova_table[2,1]`,`r vel_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', vel_dyn_aov$anova_table[2,4])`, *p* `r if(vel_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_dyn_aov$anova_table[2,5])`) and a significant interaction between Condition and Dynamics (*F*(`r vel_dyn_aov$anova_table[3,1]`,`r vel_dyn_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_dyn_aov$anova_table[3,4])`, *p* `r if(vel_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_dyn_aov$anova_table[3,5])`, *Fig \ref{fig:vel-1}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment revealed that KV was higher in the teaching condition [*M* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Forte"]$Mean`, *SD* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Forte"]$SD`] than in the performing condition [*M* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Forte"]$Mean`, *SD* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Forte"]$SD`] (*p* `r if(vel_dyn_posthoc$p.value[1] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_posthoc$p.value[1]))}`) when instructed to play forte. There was no significant difference in KV between the teaching [*M* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Piano"]$Mean`, *SD* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Piano"]$SD`] and performing condition [*M* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Piano"]$Mean`, *SD* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Piano"]$SD`] (*p* `r if(vel_dyn_posthoc$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', vel_dyn_posthoc$p.value[2]))}`) when instructed to play piano.

```{r vel-dyn-1, echo = FALSE}
vel_dyn_1 <- ggpaired(vel_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KV (0-127)", title = "KV: Dynamics") +
  ylim(50, 100) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 80, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_dyn_1.png"), plot = vel_dyn_1, dpi = 300, width = 7, height = 5)
img_vel_dyn_1 <- image_read(here("paper/image", "vel_dyn_1.png"), density = 300)

# annotate * for forte
img_vel_dyn_1 <- image_annotate(img_vel_dyn_1, "*", size = 130, color = "black", location = "+725+400")
```

### KV Transition Points

Additionally, we conducted an exploratory analysis by focusing on specific points at which each subcomponent changed from one to the other (i.e., forte to piano: FtoP, piano to forte: PtoF). These points could be structurally important to make a contrast between forte and piano. We calculated the KV difference for each interval by subtracting the KV value of the current note from that of the following note. Outliers were removed using the same criteria as for the other dependent variables and less than 5 % of the data were excluded from analysis. A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Transition Type (FtoP vs. PtoF) showed that there was a significant main effect of Transition Type (*F*(`r vel_diff_dyn_aov$anova_table[2,1]`,`r vel_diff_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', vel_diff_dyn_aov$anova_table[2,4])`, *p* `r if(vel_diff_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_diff_dyn_aov$anova_table[2,5])`) and a significant interaction between Condition and Transition Type (*F*(`r vel_diff_dyn_aov$anova_table[3,1]`,`r vel_diff_dyn_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_diff_dyn_aov$anova_table[3,4])`, *p* `r if(vel_diff_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_diff_dyn_aov$anova_table[3,5])`, *Fig \ref{fig:vel-diff}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment showed that there was a larger KV difference when changing from forte to piano (*p* `r if(vel_diff_dyn_posthoc$p.value[1] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc$p.value[1]))}`) and from piano to forte (*p* `r if(vel_diff_dyn_posthoc$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc$p.value[2]))}`) in the teaching condition [FtoP: *M* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "FtoP"]$SD`; PtoF: *M* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "PtoF"]$SD`] than in the performing condition [FtoP: *M* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "FtoP"]$SD`, PtoF: *M* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "PtoF"]$SD`].

```{r vel-diff-dyn-1, echo = FALSE}
vel_diff_dyn_1 <- ggpaired(vel_diff_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Difference", title = "KV-Diff: Exp 1") +
  ylim(-40, 60) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.4, label.y = 45, method = "t.test", paired = TRUE, symnum.args = list(cutpoints = c(0, 0.0001, 0.01, 0.05, 1), symbols = c("***", "**", "*", "ns"))) + # adjust significance level according to the actual stats
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_diff_dyn_1.png"), plot = vel_diff_dyn_1, dpi = 300, width = 7, height = 5)
img_vel_diff_dyn_1 <- image_read(here("paper/image", "vel_diff_dyn_1.png"), density = 300)
```

### Key-Overlap Time (KOT)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Dynamics (forte vs. piano) revealed that there was a significant main effect of Dynamics (*F*(`r kot_dyn_aov$anova_table[2,1]`,`r kot_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', kot_dyn_aov$anova_table[2,4])`, *p* `r if(kot_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kot_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', kot_dyn_aov$anova_table[2,5])`, *Fig \ref{fig:kot-1}*), reflecting more key-overlap for forte notes compared to piano notes. Neither the main effect of Condition (*F*(`r kot_dyn_aov$anova_table[1,1]`,`r kot_dyn_aov$anova_table[1,2]`) = `r sprintf('%.2f', kot_dyn_aov$anova_table[1,4])`, *p* `r if(kot_dyn_aov$anova_table[1,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', kot_dyn_aov$anova_table[1,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', kot_dyn_aov$anova_table[1,5])`) nor the interaction between Condition and Dynamics (*F*(`r kot_dyn_aov$anova_table[3,1]`,`r kot_dyn_aov$anova_table[3,2]`) = `r sprintf('%.3f', kot_dyn_aov$anova_table[3,4])`, *p* `r if(kot_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', kot_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', kot_dyn_aov$anova_table[3,5])`) was significant.

```{r kot-dyn-1, include = FALSE}
kot_dyn_1 <- ggpaired(kot_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KOT (ms)", title = "KOT: Dynamics") +
  ylim(-170, 105) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = -50, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "kot_dyn_1.png"), plot = kot_dyn_1, dpi = 300, width = 7, height = 5)
img_kot_dyn_1 <- image_read(here("paper/image", "kot_dyn_1.png"), density = 300)
```

## Discussion

The findings from Experiment 1 indicated that skilled pianists modified their performance for teaching purposes. For IOIs, we found a small but significant slowing down during teaching specifically when playing the piece with the notated articulation. This finding is in line with earlier studies that found slower performance of actions in a teaching context [e.g., @brand_2002; @mcellin_2017]. However, we did not find a significant difference in tempo when participants were teaching dynamics. It could be that trying to keep the prescribed tempo (conveyed through the leading metronome) limited the extent to which participants slowed down their performance during teaching. Another possibility is that slower performance may be beneficial to highlight the relation between two notes (i.e., to what extent two notes overlap) and was therefore employed when teaching articulation, whereas slower performance might not help when teaching dynamics. 

The results for KOT and KV showed that participants successfully highlighted relevant aspects of articulation and dynamics. Specifically, participants exaggerated staccato when teaching articulation and forte when teaching dynamics. Moreover, our exploratory analysis demonstrated that participants made a larger contrast in dynamics at transition points (i.e., forte to piano or piano to forte). Importantly, participants did not modulate their performance in terms of irrelevant aspects of the techniques for teaching purposes (e.g., modulating the smoothness of sound while teaching dynamics). These findings confirmed that participants modulated their performance in systematic and fine-grained ways to teach particular techniques.

```{r plot-ioi-1, out.width = "100%", fig.cap = "\\label{fig:ioi-1}Experiment 1: IOIs (ms) when playing the piece with either articulation (left) or dynamics (right). A dashed line represents the tempo given by a metronome. Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_ioi_1 <- image_append(c(img_ioi_art_1, img_ioi_dyn_1))
img_ioi_1 <- image_scale(img_ioi_1, "2200")
image_write(img_ioi_1, path = here("paper/figure", "Fig2.tiff"), format = "tiff")
img_ioi_1
```

```{r plot-kot-1, out.width = "100%", fig.cap = "\\label{fig:kot-1}Experiment 1: KOT (ms) when playing the piece with either articulation (left) or dynamics (right). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_kot_1 <- image_append(c(img_kot_art_1, img_kot_dyn_1))
img_kot_1 <- image_scale(img_kot_1, "2200")
image_write(img_kot_1, path = here("paper/figure", "Fig3.tiff"), format = "tiff")
img_kot_1
```

```{r plot-vel-1, out.width = "100%", fig.cap = "\\label{fig:vel-1}Experiment 1: KV (0-127) when playing the piece with either articulation (left) or dynamics (right). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_vel_1 <- image_append(c(img_vel_art_1, img_vel_dyn_1))
img_vel_1 <- image_scale(img_vel_1, "2200")
image_write(img_vel_1, path = here("paper/figure", "Fig4.tiff"), format = "tiff")
img_vel_1
```

\newpage

# Experiment 2

In Experiment 1, we employed a simple musical scale to maximise experimental control. To test whether our results generalise to a more naturalistic piece, in Experiment 2, we chose an actual piano piece and modified it for the purpose of the experiment. If pianists selectively highlight the relevant aspects of the techniques to be taught also in a more naturalistic piece containing more opportunities for expression, key-overlap time should be again more positive for legato and more negative for staccato while teaching articulation. When teaching dynamics, key velocity should be higher for forte and lower for piano. Given the findings we observed in Experiment 1, we also predicted that participants would make a larger key velocity contrast between forte and piano at transition points, and that they might play more slowly when teaching, especially when teaching articulation.

## Materials and methods
```{r methods-2, include = FALSE}
source(here("experiment-2/analysis/demographics", "questionnaire.R"), chdir = TRUE)
source(here("experiment-2/analysis/preprocessor", "error_summary.R"), chdir = TRUE)
```

### Participants

We recruited 21 piano experts who already had a degree (above bachelor or equivalent) in piano performance/teaching or were studying advanced piano performance at a music school at the time of recruitment. For data analysis, we excluded one participant due to insufficient motor skills. Twenty participants (`r nrow(dt_2_included[Gender == "Female"])` female) were included in the data analysis. Most participants were right-handed (left: `r nrow(dt_2_included[Handedness == "Left"])`) with a mean age of `r round(mean(dt_2_included$Age), 2)` (*SD* = `r round(sd(dt_2_included$Age), 2)`). They had `r round(mean(dt_2_included$PianoTotalPractice), 2)` years of practice on average (*SD* = `r round(sd(dt_2_included$PianoTotalPractice), 2)`). `r nrow(dt_2_included[TeachingPiano == "Yes"])` participants had an experience in teaching the piano (*M* = `r round( mean(dt_2_included[TeachingPiano == "Yes"]$TeachingPianoYears), 2)` years, *SD* = `r round( sd(dt_2_included[TeachingPiano == "Yes"]$TeachingPianoYears), 2)`). All participants gave their informed consent before the experiment started and received vouchers for their participation. The study (No. 2018-124) was approved by the United Ethical Review Committee for Research in Psychology (EPKEB) in Hungary.

### Apparatus and stimuli

The same apparatus as in Experiment 1 was used. We selected Clementi's Sonatina Op.36 (No.3) in C major as a stimulus because it contains our targeted expressions (i.e., articulation and dynamics) and is relatively simple in terms of motor skills. The first 12 measures of the original piece were used and modified so that the piece had an almost equal number of data points for each dependent variable. The modified piece consisted of a 12-measure isochronous melody notated in 4/4 meter to be played with the right hand only. Original sheet music was used for the purpose of practice (*Fig \ref{fig:stimuli-2} A*). Expressive notations were added to the original sheet music for the experiment (*Fig \ref{fig:stimuli-2} B-C*). These excerpts were confirmed to be musically natural by a doctoral student in piano performance at Liszt Ferenc Academy of Music in Hungary. The fingering was also assigned and confirmed by the same doctoral student.

### Procedure{#procedure-2}

We employed the same procedure as in Experiment 1 with several modifications. First, all participants were required to memorise the piece without expressive notations (i.e., *Fig \ref{fig:stimuli-2} A*) prior to the experiment so that they had enough time to familiarise themselves with the piece and perform it without pitch errors while performing it with different notated expressions in the lab. Second, we modified the wording of instructions for the performing condition so that both instructions had the same focus on expressive notations because there had been less emphasis on expression in the instruction in the performing condition in Experiment 1 (see details in *[Supplementary material](#supplementary)*). Third, participants could choose their preferred tempo from one of three options (100, 110 and 120 quarter beats per minute) because some evidence show that musicians have their own preferred tempo, which affects their temporal variability [@zamm_2018]. The chosen tempo was again cued by a leading metronome.  To make sure that participants memorised the piece and had sufficient motor skills, we asked participants to perform the piece without looking at the original sheet music (*Fig \ref{fig:stimuli-2} A*). Those who could not perform the piece without pitch errors twice consecutively within five attempts were excluded from data analysis (as a result, one participant was excluded). The rest of the procedure was identical to Experiment 1.

### Data analysis

Data cleaning, preprocessing and statistical analysis were almost identical to Experiment 1. For statistical analysis, only 8th notes with expressive notations were included. As a result, only one 8th note in the 4th measure without any expression was not included. IOIs were normalised by their preferred tempo because each participant chose a tempo from the three options. Given the different tempi, key-overlap ratios (KORs) were calculated by dividing KOT by the mean IOI of each performance to normalise KOT. Additionally, we included KV difference (i.e., KV difference for each interval) at transition points (i.e., forte to piano or piano to forte) as a dependent variable based on the findings of Experiment 1. Three trials were entirely excluded from data analysis because participants did not follow the sheet music closely enough. Using the same approach as in Experiment 1, pitch errors were removed manually. For onsets, `r round(sum(error_onset_summary_2$N)/((20*4*8)-3)*100, 2)`% of the trials contained at least one pitch error (extra notes: `r round(error_onset_summary_2[Reason == "Extra Notes"]$N/((20*4*8)-3)*100, 2)`%, missing notes: `r round(error_onset_summary_2[Reason == "Missing Notes"]$N/((20*4*8)-3)*100, 2)`%, substituted notes: `r round(error_onset_summary_2[Reason == "Substituted"]$N/((20*4*8)-3)*100, 2)`%). For offsets, `r round(sum(error_offset_summary_2$N)/((20*4*8)-3)*100, 2)`% of the trials contained at least one pitch error (extra notes: `r round(error_offset_summary_2[Reason == "Extra Notes"]$N/((20*4*8)-3)*100, 2)`%, missing notes: `r round(error_offset_summary_2[Reason == "Missing Notes"]$N/((20*4*8)-3)*100, 2)`%, substituted notes: `r round(error_offset_summary_2[Reason == "Substituted"]$N/((20*4*8)-3)*100, 2)`%). As a result, less than 1 % of total responses were corrected. For each dependent variable, removing outliers (i.e., responses outside 3 standard deviations from the mean) resulted in less than 5% of overall responses being removed.

```{r stim-2, out.width = "100%", fig.cap = "\\label{fig:stimuli-2}(A)Original sheet music. (B)Articulation. The curved line (slur) indicates legato and the dots indicate staccato. (C)Dynamics. The symbol `f' denotes forte and the symbol `p' denotes piano. For data analysis, only the 8th notes were included.", echo = FALSE}
stim_a_2 <- image_border(image_read(here("paper/sheetmusic/2", "stim_a.png")), "#FFFFFF", "120x120")
stim_d_2 <- image_border(image_read(here("paper/sheetmusic/2", "stim_d.png")), "#FFFFFF", "120x120")
stim_n_2 <- image_border(image_read(here("paper/sheetmusic/2", "stim_n.png")), "#FFFFFF", "120x120")

# combine
img_stimuli_2 <- image_append(c(stim_n_2, stim_a_2, stim_d_2), stack = TRUE)
img_stimuli_2 <- image_annotate(img_stimuli_2, "(A)", size = 80, location = "+100+100", color = "black", font = "helvetica")
img_stimuli_2 <- image_annotate(img_stimuli_2, "(B)", size = 80, location = "+100+1110", color = "black", font = "helvetica")
img_stimuli_2 <- image_annotate(img_stimuli_2, "(C)", size = 80, location = "+100+2110", color = "black", font = "helvetica")
img_stimuli_2

# save
img_stimuli_2 <- image_scale(img_stimuli_2, "x2600")
image_write(img_stimuli_2, path = here("paper/figure", "Fig5.tiff"), format = "tiff")
```

## Results

```{r results-2, include = FALSE}
source(here("experiment-2/analysis/stats", "ioi.R"), chdir = TRUE)
source(here("experiment-2/analysis/stats", "articulation.R"), chdir = TRUE)
source(here("experiment-2/analysis/stats", "dynamics.R"), chdir = TRUE)
```

As Experiment 1, we first report results for performance of the piece with the notated expression of articulation (*Fig \ref{fig:stimuli-2} B*), followed by performance of the piece with the notated expression of dynamics (*Fig \ref{fig:stimuli-2} C*).

## Articulation
### Inter-onset Intervals (IOIs)

A paired-sample *t*-test showed that participants played more slowly in the teaching condition [*M* = `r sprintf('%.2f', ioi_art_all[Condition == "teaching"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_art_all[Condition == "teaching"]$SD)`] than in the performing condition [*M* = `r sprintf('%.2f', ioi_art_all[Condition == "performing"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_art_all[Condition == "performing"]$SD)`] while playing the piece with the notated articulation (*t*(`r ioi_art_ttest$parameter`) = `r sprintf('%.2f', abs(ioi_art_ttest$statistic))`
, *p* `r if(ioi_art_ttest$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_ttest$p.value))}`, Cohen's *d* = `r round(abs(coheneff_art$effsize), 3)`, two-tailed, *Fig \ref{fig:ioi-2}*). A Wilcoxon Signed-rank test also confirmed that there was a significant difference between the two conditions (*p* `r if(ioi_art_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_art$effsize, 2)`, two-tailed).

```{r ioi-art-2, echo = FALSE}
ioi_art_2 <- ggpaired(ioi_art_plot, cond1 = "performing", cond2 = "teaching", color = "condition", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Normalised IOIs", title = "IOIs: Articulation") +
  ylim(0.8, 1.1) +
  geom_hline(yintercept = 1, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 1.05, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_art_2.png"), plot = ioi_art_2, dpi = 300, width = 5, height = 5)
img_ioi_art_2 <- image_read(here("paper/image", "ioi_art_2.png"), density = 300)
```

### Key-Overlap Ratios (KORs)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Articulation (legato vs. staccato) showed that there was a significant main effect of Articulation (*F*(`r kor_art_aov$anova_table[2,1]`,`r kor_art_aov$anova_table[2,2]`) = `r sprintf('%.0f', kor_art_aov$anova_table[2,4])`, *p* `r if(kor_art_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kor_art_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', kor_art_aov$anova_table[2,5])`) and a significant interaction between Condition and Articulation (*F*(`r kor_art_aov$anova_table[3,1]`,`r kor_art_aov$anova_table[3,2]`) = `r sprintf('%.2f', kor_art_aov$anova_table[3,4])`, *p* `r if(kor_art_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kor_art_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', kor_art_aov$anova_table[3,5])`, *Fig \ref{fig:kor-2}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment showed that for staccato KORs were more negative in the teaching condition [*M* = `r kor_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$Mean`, *SD* = `r kor_art_all[Condition == "teaching" & Subcomponent == "Staccato"]$SD`] than in the performing condition [*M* = `r kor_art_all[Condition == "performing" & Subcomponent == "Staccato"]$Mean`, *SD* = `r kor_art_all[Condition == "performing" & Subcomponent == "Staccato"]$SD`] (*p* = `r if(kor_art_posthoc$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kor_art_posthoc$p.value[2]))}`). For legato there was no significant difference in KORs between the teaching [*M* = `r kor_art_all[Condition == "teaching" & Subcomponent == "Legato"]$Mean`, *SD* = `r kor_art_all[Condition == "teaching" & Subcomponent == "Legato"]$SD`] and performing condition [*M* = `r kor_art_all[Condition == "performing" & Subcomponent == "Legato"]$Mean`, *SD* = `r kor_art_all[Condition == "performing" & Subcomponent == "Legato"]$SD`] (*p* = `r sprintf('%.2f', kor_art_posthoc$p.value[1])`).  

```{r kor-art-2, include = FALSE}
kor_art_2 <- ggpaired(kor_art_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KORs", title = "KORs: Articulation") +
  ylim(-1, 0.4) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.45, label.y = -0.5, method = "t.test", paired = TRUE, symnum.args = list(cutpoints = c(0, 0.0001, 0.01, 0.05, 1), symbols = c("***", "**", "*", "ns"))) + # adjust significance level according to the actual stats
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "kor_art_2.png"), plot = kor_art_2, dpi = 300, width = 7, height = 5)
img_kor_art_2 <- image_read(here("paper/image", "kor_art_2.png"), density = 300)
```

### Key Velocity (KV)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Articulation (legato vs. staccato) showed that there was a significant main effect of Articulation (*F*(`r vel_art_aov$anova_table[2,1]`,`r vel_art_aov$anova_table[2,2]`) = `r sprintf('%.2f', vel_art_aov$anova_table[2,4])`, *p* `r if(vel_art_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_art_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_art_aov$anova_table[2,5])`, *Fig \ref{fig:vel-2}*), reflecting louder sound for legato notes compared to staccato notes. Neither the main effect of Condition (*F*(`r vel_art_aov$anova_table[1,1]`,`r vel_art_aov$anova_table[1,2]`) = `r sprintf('%.2f', vel_art_aov$anova_table[1,4])`, *p* `r if(vel_art_aov$anova_table[1,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', vel_art_aov$anova_table[1,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_art_aov$anova_table[1,5])`) nor the interaction between Condition and Articulation (*F*(`r vel_art_aov$anova_table[3,1]`,`r vel_art_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_art_aov$anova_table[3,4])`, *p* `r if(vel_art_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', vel_art_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_art_aov$anova_table[3,5])`) was significant.

```{r vel-art-2, echo = FALSE}
vel_art_2 <- ggpaired(vel_art_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KV (0-127)", title = "KV: Articulation") +
  ylim(c(50, 100)) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 90, method = "t.test", paired = TRUE) + 
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_art_2.png"), plot = vel_art_2, dpi = 300, width = 7, height = 5)
img_vel_art_2 <- image_read(here("paper/image", "vel_art_2.png"), density = 300)
```

## Dynamics
### Inter-onset Intervals (IOIs)

A paired-sample *t*-test showed no significant difference between the teaching condition [*M* = `r sprintf('%.2f', ioi_dyn_all[Condition == "teaching"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_dyn_all[Condition == "teaching"]$SD)`] and the performing condition [*M* = `r sprintf('%.2f', ioi_dyn_all[Condition == "performing"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_dyn_all[Condition == "performing"]$SD)`] while playing the piece with the notated dynamics (*t*(`r ioi_dyn_ttest$parameter`) = `r sprintf('%.2f', abs(ioi_dyn_ttest$statistic))`, *p* `r if(ioi_dyn_ttest$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_ttest$p.value))}`, Cohen's *d* = `r round(abs(coheneff_dyn$effsize), 3)`, two-tailed, *Fig \ref{fig:ioi-2}*). A Wilcoxon Signed-rank test also confirmed that there was no significant difference between the two conditions (*p* `r if(ioi_dyn_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_dyn$effsize, 2)`, two-tailed).

```{r ioi-dyn-2, echo = FALSE}
ioi_dyn_2 <- ggpaired(ioi_dyn_plot, cond1 = "performing", cond2 = "teaching", color = "condition", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Normalised IOIs", title = "IOIs: Dynamics") +
  ylim(0.8, 1.1) +
  geom_hline(yintercept = 1, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 1.05, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_dyn_2.png"), plot = ioi_dyn_2, dpi = 300, width = 5, height = 5)
img_ioi_dyn_2 <- image_read(here("paper/image", "ioi_dyn_2.png"), density = 300)
```

### Key Velocity (KV)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Dynamics (forte vs. piano) showed that there was a significant main effect of Dynamics (*F*(`r vel_dyn_aov$anova_table[2,1]`,`r vel_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', vel_dyn_aov$anova_table[2,4])`, *p* `r if(vel_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_dyn_aov$anova_table[2,5])`) and a significant interaction between Condition and Dynamics (*F*(`r vel_dyn_aov$anova_table[3,1]`,`r vel_dyn_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_dyn_aov$anova_table[3,4])`, *p* `r if(vel_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_dyn_aov$anova_table[3,5])`, *Fig \ref{fig:vel-2}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment revealed that KV was higher in the teaching condition [*M* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Forte"]$Mean`, *SD* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Forte"]$SD`] than in the performing condition [*M* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Forte"]$Mean`, *SD* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Forte"]$SD`] (*p* `r if(vel_dyn_posthoc$p.value[1] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_posthoc$p.value[1]))}`) when instructed to play forte. Also, KV was lower in the teaching condition [*M* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Piano"]$Mean`, *SD* = `r vel_dyn_all[Condition == "teaching" & Subcomponent == "Piano"]$SD`] than in the performing condition [*M* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Piano"]$Mean`, *SD* = `r vel_dyn_all[Condition == "performing" & Subcomponent == "Piano"]$SD`] (*p* `r if(vel_dyn_posthoc$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_dyn_posthoc$p.value[2]))}`) when instructed to play piano.

```{r vel-dyn-2, echo = FALSE}
vel_dyn_2 <- ggpaired(vel_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KV (0-127)", title = "KV: Dynamics") +
  ylim(c(50, 100)) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 90, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_dyn_2.png"), plot = vel_dyn_2, dpi = 300, width = 7, height = 5)
img_vel_dyn_2 <- image_read(here("paper/image", "vel_dyn_2.png"), density = 300)
```

### KV Transition Points

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Transition Type (FtoP vs. PtoF) showed that there was a significant main effect of Transition Type (*F*(`r vel_diff_dyn_aov$anova_table[2,1]`,`r vel_diff_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', vel_diff_dyn_aov$anova_table[2,4])`, *p* `r if(vel_diff_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_diff_dyn_aov$anova_table[2,5])`) and a significant interaction between Condition and Transition Type (*F*(`r vel_diff_dyn_aov$anova_table[3,1]`,`r vel_diff_dyn_aov$anova_table[3,2]`) = `r sprintf('%.2f', vel_diff_dyn_aov$anova_table[3,4])`, *p* `r if(vel_diff_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_diff_dyn_aov$anova_table[3,5])`, *Fig \ref{fig:vel-diff}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment showed that there was a larger KV difference when changing from forte to piano (*p* `r if(vel_diff_dyn_posthoc$p.value[1] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc$p.value[1]))}`) and from piano to forte (*p* `r if(vel_diff_dyn_posthoc$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc$p.value[2]))}`) in the teaching condition [FtoP: *M* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "FtoP"]$SD`, PtoF: *M* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "teaching" & Subcomponent == "PtoF"]$SD`] than in the performing condition [FtoP: *M* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "FtoP"]$SD`, PtoF: *M* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_all[Condition == "performing" & Subcomponent == "PtoF"]$SD`].

```{r vel-diff-dyn-2, echo = FALSE}
vel_diff_dyn_2 <- ggpaired(vel_diff_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Difference", title = "KV-Diff: Exp 2") +
  ylim(-40, 60) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.45, label.y = 45, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_diff_dyn_2.png"), plot = vel_diff_dyn_2, dpi = 300, width = 7, height = 5)
img_vel_diff_dyn_2 <- image_read(here("paper/image", "vel_diff_dyn_2.png"), density = 300)
```

### Key-Overlap Ratios (KORs)

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Dynamics (forte vs. piano) showed that there was a significant main effect of Dynamics (*F*(`r kor_dyn_aov$anova_table[2,1]`,`r kor_dyn_aov$anova_table[2,2]`) = `r sprintf('%.0f', kor_dyn_aov$anova_table[2,4])`, *p* `r if(kor_dyn_aov$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', kor_dyn_aov$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', kor_dyn_aov$anova_table[2,5])`), reflecting more key-overlap for forte notes compared to piano notes. Neither the main effect of Condition (*F*(`r kor_dyn_aov$anova_table[1,1]`,`r kor_dyn_aov$anova_table[1,2]`) = `r sprintf('%.3f', kor_dyn_aov$anova_table[1,4])`, *p* `r if(kor_dyn_aov$anova_table[1,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', kor_dyn_aov$anova_table[1,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', kor_dyn_aov$anova_table[1,5])`) nor the interaction between Condition and Dynamics (*F*(`r kor_dyn_aov$anova_table[3,1]`,`r kor_dyn_aov$anova_table[3,2]`) = `r sprintf('%.2f', kor_dyn_aov$anova_table[3,4])`, *p* `r if(kor_dyn_aov$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', kor_dyn_aov$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', kor_dyn_aov$anova_table[3,5])`, *Fig \ref{fig:kor-2}*) was significant.

```{r kor-dyn-2, include = FALSE}
kor_dyn_2 <- ggpaired(kor_dyn_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "KORs", title = "KORs: Dynamics") +
  ylim(-1, 0.4) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = -0.5, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "kor_dyn_2.png"), plot = kor_dyn_2, dpi = 300, width = 7, height = 5)
img_kor_dyn_2 <- image_read(here("paper/image", "kor_dyn_2.png"), density = 300)
```

## Discussion

The results from Experiment 2 replicate our earlier findings and provide further evidence that skilled pianists modulated their performance in specific ways for teaching purposes. As in Experiment 1, we observed slower performance only while teaching the notated articulation. Again, KORs showed that when teaching articulation, participants exaggerated staccato while there was no significant difference in legato between the two conditions. While teaching dynamics, KV showed that participants exaggerated forte and piano. This pattern of exaggeration was more pronounced than in Experiment 1, where only higher KV for forte was observed. Furthermore, we again found that when teaching dynamics, at transition points participants produced a larger contrast in dynamics between forte and piano, bidirectionally. Importantly, participants did not modulate performance aspects that were irrelevant for the techniques to be taught (i.e., no modulation of dynamics when teaching articulation and vice versa). Overall, Experiment 2 demonstrated systematic and fine-grained didactic performance modulations for a naturalistic piece of music.

```{r plot-ioi-2, out.width = "100%", fig.cap = "\\label{fig:ioi-2}Experiment 2: Normalised IOIs when playing the piece with either articulation (left) or dynamics (right). A dashed line represents the tempo given by a metronome. Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_ioi_2 <- image_append(c(img_ioi_art_2, img_ioi_dyn_2))
img_ioi_2 <- image_scale(img_ioi_2, "2200")
image_write(img_ioi_2, path = here("paper/figure", "Fig6.tiff"), format = "tiff")
img_ioi_2
```

```{r plot-kor-2, out.width = "100%", fig.cap = "\\label{fig:kor-2}Experiment 2: KORs when playing the piece with either articulation (left) or dynamics (right). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_kor_2 <- image_append(c(img_kor_art_2, img_kor_dyn_2))
img_kor_2 <- image_scale(img_kor_2, "2200")
image_write(img_kor_2, path = here("paper/figure", "Fig7.tiff"), format = "tiff")
img_kor_2
```

```{r plot-vel-2, out.width = "100%", fig.cap = "\\label{fig:vel-2}Experiment 2: KV (0-127) when playing the piece with either articulation (left) or dynamics (right). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_vel_2 <- image_append(c(img_vel_art_2, img_vel_dyn_2))
img_vel_2 <- image_scale(img_vel_2, "2200")
image_write(img_vel_2, path = here("paper/figure", "Fig8.tiff"), format = "tiff")
img_vel_2
```

```{r plot-vel-diff, out.width = "100%", fig.cap = "\\label{fig:vel-diff}Experiment 1, 2: KV Difference at transition points when playing the piece with dynamics (left: Experiment 1, right: Experiment 2). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
# combine
img_vel_diff <- image_append(c(img_vel_diff_dyn_1, img_vel_diff_dyn_2))
img_vel_diff <- image_scale(img_vel_diff, "2200")
image_write(img_vel_diff, path = here("paper/figure", "Fig9.tiff"), format = "tiff")
img_vel_diff
```

\newpage

# General Discussion

The aim of this study was to investigate how expert pianists modulate their performance to teach expressive techniques. Overall, the findings of the two experiments showed that pianists performed one and the same piece differently depending on whether they played with the intention to teach expressive techniques or with the intention to perform the piece for an audience. When playing with the intention to teach, pianists selectively highlighted relevant aspects of artistic expressions. Across two different pieces, participants exaggerated staccato when playing with the intention to teach expressions concerning articulation. The lack of a difference for legato when teaching articulation might stem from a ceiling effect because there might not be enough room for exaggeration without significantly dropping the tempo. When playing with the intention to teach expressions concerning dynamics, participants made larger dynamics changes between forte and piano (in both directions). This constitutes an effective way to highlight the technique as loudness is determined relatively. Taken together, our findings demonstrate that expert pianists systematically modulated their sound depending on the specific technique they were trying to convey.

Although participants tended to play slower in the teaching condition than in the performing condition in general, we found a significant difference only for articulation, not for dynamics. As mentioned in the discussion of Experiment 1, it could be that the metronome beats given prior to each performance discouraged participants from deviating from the prescribed tempo. Another possibility is that expression is best taught when leaving the tempo unchanged when it is irrelevant. This would imply that general didactic modulations like slowing down might be less useful in the context of teaching techniques where timing itself can be used to add an expression to a performance.

One limitation of the study is that although we instructed participants to imagine a situation in which they were teaching musical expression to students, there was no feedback from actual students. It can be expected that teachers would also make didactic modulations in some domains other than acoustic properties, such as gestures if they are physically present in front of students. Moreover, given that teachers modulate their demonstration throughout ongoing interactions with learners [@okazaki_2019], future studies are needed to investigate how experts dynamically adapt their performance to their students’ skill level and demonstrated abilities. Also, some of the participants in the current study did not have teaching experience at all and even those who had teaching experience had taught for only a few years. It would be important to investigate if our findings would be observed in participants with extensive experience teaching the piano.

Another limitation of the study is that it is not certain how the results might generalise to performances of more complex pieces and pieces with fewer notations. In more complex pieces of music, multiple expressive notations could be assigned to one note or phrase. Also, it is rare that almost all the notes are assigned to one expressive notation as in our stimuli. Future studies are needed to determine whether pianists would exaggerate specific parts of a piece or prioritise one aspect over the others given multiple concurrent expressive notations and more possibilities for giving the music different interpretations.

Musicians and music teachers tend to consider expressive skills as performers’ most important skills [@lindstrom_2003]. In the present study, experts focused on the teaching of expressions that were notated. However, expression also has other facets [@juslin_2003] that are not only piece-related (e.g., notated expressions) but performer- or context-related (e.g., performer’s interpretation, listening contexts such as recordings or concerts). The ultimate goal of expressive performance is considered to lie in developing performers’ own interpretations of music and convey affects and emotions by using expressive tools such as articulation, dynamics, tempo and timing [@meissner_2021]. The current research opens up the possibility of studying the teaching of expressive performance by demonstrating that pianists could signal didactic intentions without relying on verbal instructions, which are heavily used in actually teaching settings [e.g., @woody_2000]. It would be interesting to examine how teachers play (i.e., demonstrate) relates to verbal instructions they give.

The present findings extend earlier research on teaching-related action modulations. First, our study sheds light on the teaching of technical skills that are an integral part of skill acquisition in artistic domains. We showed that compared to an expressive performance baseline, experts made specific modulations to teach particular techniques. Second, the specificity of the observed modulations supports the idea that teaching comprises more than generic modulations like slowing down or overall exaggeration that may draw learners’ attention. Rather, expert demonstrators seem to follow principles of relevance in communication [@sperber_1995], highlighting only those aspects they are intending to demonstrate. How learners benefit from the perceptual and motor cues that come with specific exaggerations, and whether understanding the teacher's intentions explicitly adds to the learning success are important questions for future research.   

# References

\begingroup
\setlength{\parindent}{-0in}
\setlength{\leftskip}{0in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup

# Acknowledgements
This research was supported by the European Research Council under the European Union’s Seventh Framework Program (FP7/2007–2013)/ERC Grant agreement no. 609819, SOMICS, and by ERC Grant agreement no. 616072, JAXPERTISE. We thank Dávid Csűrös for his help with data collection. 

# Author contributions
A.T, G.K and N.S developed the study concept and designed the experiments. Stimuli and procedure were created by A.T. Data collection and analyses were performed by A.T. under the supervision of G.K. and N.S. A.T. drafted the manuscript, and N.S. and G.K. provided critical revisions. All authors approved the final version of the manuscript for submission.

# Data availability statement
All data is available at [https://osf.io/8nbjh/](https://osf.io/8nbjh/).

# Competing interests
The authors declare no competing interests.

\clearpage

# Supplementary material{#supplementary}

# Instructions

## Experiment 1

In the teaching condition, participants were shown the following instruction on a computer monitor (Italic sentences were highlighted in yellow colour on a black background): "Now, play what you practised as if you were teaching it to students. Students already know how to produce the sequence of the tones and now are trying to *learn how to perform the piece expressively* by listening to your performance. *Do your best as a teacher to produce the piece according to the notation that you just practised.*"

In the performing condition, participants were shown the following instruction on a computer monitor: "Now, play what you practised as if you were performing it to an audience. *Do your best as a performer to produce the piece according to the notation that you just practised.*"

## Experiment 2

In the teaching condition of Experiment 2, we gave participants the exact same instruction as in Experiment 1. In the performing condition, participants were given the following instruction on a computer monitor: "Now, play what you practised as if you were performing it to an audience. *Perform the piece expressively with your interpretation. Do your best as a performer to produce the piece according to the notation that you just practised.*"

\clearpage

# Temporal Variability

The tempo variability of performance was assessed with the coefficient of variation (CV) of the IOIs to investigate the tempo stability of performance between the teaching and performing condition. CVs were calculated by dividing the standard deviation by the mean of IOIs.

## Results
## Experiment 1
```{r variability-1, include = FALSE}
source(here("experiment-1/analysis/stats", "variability.R"), chdir = TRUE)
```

### Articulation

To compare the mean CVs between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_art_cv_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_cv_norm$p.value))}`). The Wilcoxon Signed-rank test showed that the tempo variability of performance did not differ significantly between the teaching [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "articulation"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "articulation"]$IQR)`] and performing condition [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "articulation"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "articulation"]$IQR)`] while playing the piece with the notated articulation (*p* `r if(ioi_art_cv_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_art_cv_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_art_cv$effsize, 2)`, two-tailed, *Fig \ref{fig:cv}*).

### Dynamics

To compare the mean CVs between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_dyn_cv_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_dyn_cv_norm$p.value))}`). The Wilcoxon Signed-rank test showed that the tempo variability of performance did not differ significantly between the teaching [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$IQR)`] and performing condition [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "dynamics"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "dynamics"]$IQR)`] while playing the piece with the notated dynamics (*p* `r if(ioi_dyn_cv_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_cv_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_dyn_cv$effsize, 2)`, two-tailed, *Fig \ref{fig:cv}*).

```{r ioi-cv-1, echo = FALSE}
ioi_cv_plot <- data.table(subject = ioi_cv_subject[Condition == "teaching"]$SubNr, teaching = ioi_cv_subject[Condition == "teaching"]$MeanCV, performing = ioi_cv_subject[Condition == "performing"]$MeanCV, skill = ioi_cv_subject[Condition == "teaching"]$Skill)

ioi_cv_1 <- ggpaired(ioi_cv_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "skill", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "CVs", title = "CVs: Exp 1") +
  ylim(0, 0.20) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 0.08, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_cv_1.png"), plot = ioi_cv_1, dpi = 300, width = 7, height = 5)
img_ioi_cv_1 <- image_read(here("paper/image", "ioi_cv_1.png"), density = 300)
```

## Experiment 2
```{r variability-2, include = FALSE}
source(here("experiment-2/analysis/stats", "variability.R"), chdir = TRUE)
```

### Articulation

To compare the mean CVs between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_art_cv_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_cv_norm$p.value))}`). The Wilcoxon Signed-rank test showed that the tempo variability of performance did not differ significantly between the teaching [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "articulation"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "articulation"]$IQR)`] and performing condition [*Mdn* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "articulation"]$Median)`, *IQR* = `r sprintf('%.3f', ioi_cv[Condition == "performing" & Skill == "articulation"]$IQR)`] while playing the piece with the notated articulation (*p* `r if(ioi_art_cv_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_art_cv_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_art_cv$effsize, 2)`, two-tailed, *Fig \ref{fig:cv}*).

### Dynamics

A paired-sample *t*-test showed that the tempo variability of performance did not differ significantly between the teaching [*M* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$SD)`] and the performing condition [*M* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_cv[Condition == "teaching" & Skill == "dynamics"]$SD)`] while playing the piece with the notated dynamics (*t*(`r ioi_dyn_cv_ttest$parameter`) = `r sprintf('%.2f', abs(ioi_dyn_cv_ttest$statistic))`, *p* `r if(ioi_dyn_cv_ttest$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_cv_ttest$p.value))}`, Cohen's *d* = `r round(abs(coheneff_dyn_cv$effsize), 3)`, two-tailed, *Fig \ref{fig:cv}*).

```{r ioi-cv-2, echo = FALSE}
ioi_cv_plot <- data.table(subject = ioi_cv_subject[Condition == "teaching"]$SubNr, teaching = ioi_cv_subject[Condition == "teaching"]$MeanCV, performing = ioi_cv_subject[Condition == "performing"]$MeanCV, skill = ioi_cv_subject[Condition == "teaching"]$Skill)

ioi_cv_2 <- ggpaired(ioi_cv_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "skill", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "CVs", title = "CVs: Exp 2") +
  ylim(0, 0.20) +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 0.08, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_cv_2.png"), plot = ioi_cv_2, dpi = 300, width = 7, height = 5)
img_ioi_cv_2 <- image_read(here("paper/image", "ioi_cv_2.png"), density = 300)
```

```{r plot-cv, out.width = "100%", fig.cap = "\\label{fig:cv}Experiment 1, 2: CVs when playing the piece with either articulation or dynamics (left: Experiment 1, right: Experiment 2). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
img_ioi_cv <- image_append(c(img_ioi_cv_1, img_ioi_cv_2))
img_ioi_cv <- image_scale(img_ioi_cv, "2200")
image_write(img_ioi_cv, path = here("paper/figure", "Fig12.tiff"), format = "tiff")
img_ioi_cv
```

\clearpage

# Temporal grouping

In order to investigate if participants used temporal grouping to make boundaries between subcomponents (i.e., between legato and staccato, between forte and piano) clearer for teaching purposes, we looked at IOIs only at transition points. 

## Results
## Experiment 1
```{r variability-1-1, include = FALSE}
source(here("experiment-1/analysis/stats", "variability.R"), chdir = TRUE)
```

### Articulation

To compare the mean IOIs at transition points between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_art_tra_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_art_tra_norm$p.value))}`). The Wilcoxon Signed-rank test revealed that IOIs at transition points were larger in the teaching condition [*Mdn* = `r ioi_tra[Condition == "teaching" & Skill == "articulation"]$Median` (ms), *IQR* = `r ioi_tra[Condition == "teaching" & Skill == "articulation"]$IQR`] than in the performing condition [*Mdn* = `r ioi_tra[Condition == "performing" & Skill == "articulation"]$Median` (ms), *IQR* = `r ioi_tra[Condition == "performing" & Skill == "articulation"]$IQR`] while playing the piece with the notated articulation (*p* `r if(ioi_art_tra_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_art_tra_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_art_tra$effsize, 2)`, two-tailed, *Fig \ref{fig:tra}*).

### Dynamics

A paired-sample *t*-test showed that IOIs at transition points were larger in the teaching condition [*M* = `r ioi_tra[Condition == "teaching" & Skill == "dynamics"]$Mean` (ms), *SD* = `r ioi_tra[Condition == "teaching" & Skill == "dynamics"]$SD`] than in the performing condition [*M* = `r ioi_tra[Condition == "performing" & Skill == "dynamics"]$Mean` (ms), *SD* = `r ioi_tra[Condition == "performing" & Skill == "dynamics"]$SD`] while playing the piece with the notated dynamics (*t*(`r ioi_dyn_tra_ttest$parameter`) = `r sprintf('%.2f', abs(ioi_dyn_tra_ttest$statistic))`, *p* `r if(ioi_dyn_tra_ttest$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_tra_ttest$p.value))}`, Cohen's *d* = `r round(abs(coheneff_dyn_tra$effsize), 3)`, two-tailed, *Fig \ref{fig:tra}*).

```{r ioi-tra-1, echo = FALSE}
ioi_tra_plot <- data.table(subject = ioi_tra_subject[Condition == "teaching"]$SubNr, teaching = ioi_tra_subject[Condition == "teaching"]$Mean, performing = ioi_tra_subject[Condition == "performing"]$Mean, skill = ioi_tra_subject[Condition == "teaching"]$Skill)

ioi_tra_1 <- ggpaired(ioi_tra_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "skill", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "IOIs (ms)", title = "IOIs at transition: Exp 1") +
  geom_hline(yintercept = 188, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 150, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_tra_1.png"), plot = ioi_tra_1, dpi = 300, width = 7, height = 5)
img_ioi_tra_1 <- image_read(here("paper/image", "ioi_tra_1.png"), density = 300)
```

## Experiment 2
### Articulation
```{r variability-2-2, include = FALSE}
source(here("experiment-2/analysis/stats", "variability.R"), chdir = TRUE)
```

A paired-sample *t*-test showed that IOIs at transition points were larger in the teaching condition [*M* = `r sprintf('%.2f', ioi_tra[Condition == "teaching" & Skill == "articulation"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_tra[Condition == "teaching" & Skill == "articulation"]$SD)`] than in the performing condition [*M* = `r sprintf('%.2f', ioi_tra[Condition == "performing" & Skill == "articulation"]$Mean)`, *SD* = `r sprintf('%.3f', ioi_tra[Condition == "performing" & Skill == "articulation"]$SD)`] while playing the piece with the notated articulation (*t*(`r ioi_art_tra_ttest$parameter`) = `r sprintf('%.2f', abs(ioi_art_tra_ttest$statistic))`, *p* `r if(ioi_art_tra_ttest$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_art_tra_ttest$p.value))}`, Cohen's *d* = `r round(abs(coheneff_art_tra$effsize), 3)`, two-tailed, *Fig \ref{fig:tra}*).

### Dynamics

To compare the mean IOIs at transition points between the teaching and performing condition, we conducted a Wilcoxon Signed-rank test, instead of a paired *t*-test, because a Shapiro-Wilk test showed that the distribution of the mean difference was significantly different from the normal distribution (*p* `r if(ioi_dyn_tra_norm$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', ioi_dyn_tra_norm$p.value))}`). The Wilcoxon Signed-rank test revealed that IOIs at transition points did not differ significantly between the teaching [*Mdn* = `r ioi_tra[Condition == "teaching" & Skill == "dynamics"]$Median`, *IQR* = `r ioi_tra[Condition == "teaching" & Skill == "dynamics"]$IQR`] and the performing condition [*Mdn* = `r ioi_tra[Condition == "performing" & Skill == "dynamics"]$Median`, *IQR* = `r ioi_tra[Condition == "performing" & Skill == "dynamics"]$IQR`] while playing the piece with the notated dynamics (*p* `r if(ioi_dyn_tra_wilcoxon$p.value < 0.001){"< 0.001"} else {paste("= ", sprintf('%.2f', ioi_dyn_tra_wilcoxon$p.value))}`, *r* = `r round(wilcoxeff_dyn_tra$effsize, 2)`, two-tailed, *Fig \ref{fig:tra}*).

```{r ioi-tra-2, echo = FALSE}
ioi_tra_plot <- data.table(subject = ioi_tra_subject[Condition == "teaching"]$SubNr, teaching = ioi_tra_subject[Condition == "teaching"]$Mean, performing = ioi_tra_subject[Condition == "performing"]$Mean, skill = ioi_tra_subject[Condition == "teaching"]$Skill)

ioi_tra_2 <- ggpaired(ioi_tra_plot, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "skill", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Normalised IOIs", title = "IOIs at transition: Exp 2") +
  geom_hline(yintercept = 1, linetype = "dashed") +
  stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 1.05, method = "t.test", paired = TRUE) +
  theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "ioi_tra_2.png"), plot = ioi_tra_2, dpi = 300, width = 7, height = 5)
img_ioi_tra_2 <- image_read(here("paper/image", "ioi_tra_2.png"), density = 300)
```

```{r plot-tra, out.width = "100%", fig.cap = "\\label{fig:tra}Experiment 1, 2: IOIs at transition points when playing the piece with either articulation or dynamics (left: Experiment 1, right: Experiment 2). A dashed line represents the tempo given by a metronome. Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
img_ioi_tra <- image_append(c(img_ioi_tra_1, img_ioi_tra_2))
img_ioi_tra <- image_scale(img_ioi_tra, "2200")
image_write(img_ioi_tra, path = here("paper/figure", "Fig10.tiff"), format = "tiff")
img_ioi_tra
```

\clearpage

# Additional analysis for dynamics difference

In order to examine if the dynamics difference between forte and piano at transition points is larger when the difference between forte and piano in overall performance is considered, we normalised the KV difference at transition points by dividing it by the average range between forte and piano per performance (per trial).

## Results
## Experiment 1
```{r additional-dynamics-1, include = FALSE}
source(here("experiment-1/analysis/stats", "dynamics.R"), chdir = TRUE)
```

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Transition Type (FtoP vs. PtoF) showed that there was a significant main effect of Transition Type (*F*(`r vel_diff_dyn_aov_3$anova_table[2,1]`,`r vel_diff_dyn_aov_3$anova_table[2,2]`) = `r sprintf('%.0f', vel_diff_dyn_aov_3$anova_table[2,4])`, *p* `r if(vel_diff_dyn_aov_3$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_diff_dyn_aov_3$anova_table[2,5])`) and a significant interaction between Condition and Transition Type (*F*(`r vel_diff_dyn_aov_3$anova_table[3,1]`,`r vel_diff_dyn_aov_3$anova_table[3,2]`) = `r sprintf('%.2f', vel_diff_dyn_aov_3$anova_table[3,4])`, *p* `r if(vel_diff_dyn_aov_3$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[3,5])`, *Fig \ref{fig:vel-diff-2}*). Post-hoc comparisons based on the estimated marginal means with Tukey adjustment showed that there was no significant difference when changing from forte to piano (*p* `r if(vel_diff_dyn_posthoc_2$p.value[1] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc_2$p.value[1]))}`) and from piano to forte (*p* `r if(vel_diff_dyn_posthoc_2$p.value[2] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_posthoc_2$p.value[2]))}`) between the teaching condition [FtoP: *M* = `r vel_diff_dyn_normalised_all[Condition == "teaching" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_normalised_all[Condition == "teaching" & Subcomponent == "FtoP"]$SD`, PtoF: *M* = `r vel_diff_dyn_normalised_all[Condition == "teaching" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_normalised_all[Condition == "teaching" & Subcomponent == "PtoF"]$SD`] and the performing condition [FtoP: *M* = `r vel_diff_dyn_normalised_all[Condition == "performing" & Subcomponent == "FtoP"]$Mean`, *SD* = `r vel_diff_dyn_normalised_all[Condition == "performing" & Subcomponent == "FtoP"]$SD`, PtoF: *M* = `r vel_diff_dyn_normalised_all[Condition == "performing" & Subcomponent == "PtoF"]$Mean`, *SD* = `r vel_diff_dyn_normalised_all[Condition == "performing" & Subcomponent == "PtoF"]$SD`].

```{r vel-diff-dyn-normalised-1, echo = FALSE}
vel_diff_dyn_normalised_1 <- ggpaired(vel_diff_dyn_plot_2, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas",xlab = "Condition", ylab = "Normalised Difference", title = "KV-Diff: Exp 1") + ylim(-6, 5) + stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 3, method = "t.test", paired = TRUE) + theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_diff_dyn_normalised_1.png"), plot = vel_diff_dyn_normalised_1, dpi = 300, width = 7, height = 5)
img_vel_diff_dyn_normalised_1 <- image_read(here("paper/image", "vel_diff_dyn_normalised_1.png"), density = 300)
```

## Experiment 2
```{r additional-dynamics-2, include = FALSE}
source(here("experiment-2/analysis/stats", "dynamics.R"), chdir = TRUE)
```

A two-way repeated-measures ANOVA with the factors Condition (teaching vs. performing) and Transition Type (FtoP vs. PtoF) showed that there was a significant main effect of Transition Type (*F*(`r vel_diff_dyn_aov_3$anova_table[2,1]`,`r vel_diff_dyn_aov_3$anova_table[2,2]`) = `r sprintf('%.0f', vel_diff_dyn_aov_3$anova_table[2,4])`, *p* `r if(vel_diff_dyn_aov_3$anova_table[2,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[2,6]))}`, $\eta_G^2$ = `r sprintf('%.2f', vel_diff_dyn_aov_3$anova_table[2,5])`). However, there was no significant interaction between Condition and Transition Type (*F*(`r vel_diff_dyn_aov_3$anova_table[3,1]`,`r vel_diff_dyn_aov_3$anova_table[3,2]`) = `r sprintf('%.2f', vel_diff_dyn_aov_3$anova_table[3,4])`, *p* `r if(vel_diff_dyn_aov_3$anova_table[3,6] < 0.001){"< 0.001"} else {paste("= ", sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[3,6]))}`, $\eta_G^2$ = `r sprintf('%.3f', vel_diff_dyn_aov_3$anova_table[3,5])`, *Fig \ref{fig:vel-diff-2}*).

```{r vel-diff-dyn-normalised-2, echo = FALSE}
vel_diff_dyn_normalised_2 <- ggpaired(vel_diff_dyn_plot_2, cond = "performing", cond2 = "teaching", color = "condition", facet.by = "subcomponent", line.size = 0.3, line.color = "gray", palette = "aaas", xlab = "Condition", ylab = "Normalised Difference", title = "KV-Diff: Exp 2") + ylim(-6, 5) + stat_compare_means(label = "p.signif", hide.ns = TRUE, size = 10, label.x = 1.5, label.y = 3, method = "t.test", paired = TRUE) + theme_pubr(base_size = 20, legend = "none", base_family = "Helvetica")

# save plots
ggsave(here("paper/image", "vel_diff_dyn_normalised_2.png"), plot = vel_diff_dyn_normalised_2, dpi = 300, width = 7, height = 5)
img_vel_diff_dyn_normalised_2 <- image_read(here("paper/image", "vel_diff_dyn_normalised_2.png"), density = 300)
```

```{r plot-vel-diff-2, out.width = "100%", fig.cap = "\\label{fig:vel-diff-2}Experiment 1, 2: Normalised KV Difference at transition points when playing the piece with dynamics (left: Experiment 1, right: Experiment 2). Each box indicates the IQR with the median, and whiskers extend to a maximum of 1.5 × IQR beyond the box. Significance levels: * \\textit{p} < .05, ** \\textit{p} < .01, *** \\textit{p} < .001"}
img_vel_diff_dyn_normalised <- image_append(c(img_vel_diff_dyn_normalised_1, img_vel_diff_dyn_normalised_2))
img_vel_diff_dyn_normalised <- image_scale(img_vel_diff_dyn_normalised, "2200")
image_write(img_vel_diff_dyn_normalised, path = here("paper/figure", "Fig11.tiff"), format = "tiff")
img_vel_diff_dyn_normalised
```
