---
title: 'Dynamics: Analysis: The Sound of Teaching Music 2'
output:
  html_notebook: default
editor_options: 
  chunk_output_type: inline
---

##### Description: This is a summary of all analyses for dynamics.

## Experimental Design{#design}
- Independent variables: Condition (2 levels: teaching vs. performing) x Subcomponent (2 levels: forte vs. piano / legato vs. staccato)
- Dependent variables: Key Velocity (KV), KV difference (KV-Diff)

### Main predictions
- Participants will exaggerate forte and piano more while teaching.
- Participants will make a larger contrast between forte and piano.

```{r setup, include = FALSE}
# packages
# data manipulation
if (!require("dplyr")) {install.packages("dplyr"); require("dplyr")}
# plot
if (!require("ggplot2")) {install.packages("ggplot2"); require("ggplot2")}
if (!require("ggsignif")) {install.packages("ggsignif"); require("ggsignif")}
# statistics
if (!require("stats")) {install.packages("stats"); require("stats")}
if (!require("effsize")) {install.packages("effsize"); require("effsize")}
if (!require("ez")) {install.packages("ez"); require("ez")}

# ggplots
theme_set(theme_classic())
theme_update(text = element_text(size = 20, family = "Helvetica Neue LT Std 57 Condensed"), legend.position = "bottom")
```

```{r extract, include = FALSE}
df_vel <- read.csv("./trimmed/data_vel.csv", header = T, sep = ",", dec = ".") # read a trimmed csv
df_vel_acc <- read.csv("./trimmed/data_vel_acc.csv", header = T, sep = ",", dec = ".") # read a trimmed csv

# SubNr as a factor
df_vel$SubNr <- as.factor(df_vel$SubNr)
df_vel_acc$SubNr <- as.factor(df_vel_acc$SubNr)

# Include only articulation
df_vel_art <- df_vel %>% dplyr::filter(Skill == "articulation")
df_vel_acc_art <- df_vel_acc %>% dplyr::filter(Skill == "articulation")

# Include only dynamics
df_vel_dyn <- df_vel %>% dplyr::filter(Skill == "dynamics")
df_vel_acc_dyn <- df_vel_acc %>% dplyr::filter(Skill == "dynamics")
```

## Key Velocity (KV) - Dynamics
### 1. All - individual{#vel_dyn_ind_all}
- Average KV for each participant.

```{r vel_dyn, echo = FALSE}
# For each individual
vel_dyn <- aggregate(Velocity~SubNr*Condition*Skill*Subcomponent, data = df_vel_dyn,
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_dyn <- cbind(vel_dyn[,1:4], as.data.frame(vel_dyn[,5]))
# Change colnames
colnames(vel_dyn) <- c("SubNr", "Condition", "Skill", "Subcomponent", "N", "Mean", "SD")
print(vel_dyn)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean

```{r vel_dyn_bar,  echo = FALSE}
p_vel_dyn <- ggplot(data = vel_dyn, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Subcomponent ~ .) +
  labs(y = "KV (0-127)", subtitle = "KV: Dynamics") + coord_cartesian(ylim = c(40, 100))
p_vel_dyn
```

### 2. All - group{#vel_dyn_group_all}
- Average KV for each condition.
- Hypothesis: Participants will exaggerate forte and piano when teaching.

```{r vel_dyn_all, echo = FALSE}
# Group mean
vel_dyn_all <- aggregate(Mean~Condition*Skill*Subcomponent, data = vel_dyn,
                         FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_dyn_all <- cbind(vel_dyn_all[,1:3], as.data.frame(vel_dyn_all[,4]))
# Change colnames
colnames(vel_dyn_all) <- c("Condition", "Skill", "Subcomponent", "N", "Mean", "SD", "SEM")
print(vel_dyn_all)
```

#### Plot
##### Bar chart
- Error bars show SEM of the mean

```{r vel_dyn_all_bar, echo = FALSE}　
p_vel_dyn_all <- ggplot(data = vel_dyn_all, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width = .2, position = position_dodge(.9)) +
  labs(y = "KV (0-127)", subtitle = "KV: Dynamics") + coord_cartesian(ylim = c(40, 100))
p_vel_dyn_all
```

##### Box plot

```{r vel_dyn_all_box, echo = FALSE}
p_vel_dyn_all_box <- ggplot(data = vel_dyn, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  labs(y = "KV (0-127)", subtitle = "KV: Dynamics")
p_vel_dyn_all_box
```

#### Statistics (TBC)

### 3. Trial by trial - individual{#vel_dyn_ind_trial}
- Average KV for each trial for each participant.

```{r vel_dyn_trial, echo = FALSE}
# For each individual
vel_dyn_trial <- aggregate(Velocity~SubNr*Condition*Skill*Subcomponent*TrialNr, data = df_vel_dyn,
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_dyn_trial <- cbind(vel_dyn_trial[,1:5], as.data.frame(vel_dyn_trial[,6]))
# Change colnames
colnames(vel_dyn_trial) <- c("SubNr", "Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD")
print(vel_dyn_trial)
```

#### Plot
##### Line graph
```{r vel_dyn_trial_line_forte, echo = FALSE, fig.height = 8}
p_vel_dyn_trial_forte <- ggplot(data = subset(vel_dyn_trial, vel_dyn_trial$Subcomponent == "Forte"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Dynamics/Forte") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_dyn_trial_forte
```

```{r vel_dyn_trial_line_piano, echo = FALSE, fig.height = 8}
p_vel_dyn_trial_piano <- ggplot(data = subset(vel_dyn_trial, vel_dyn_trial$Subcomponent == "Piano"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Dynamics/Piano") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_dyn_trial_piano
```

### 4. Trial by trial - group{#vel_dyn_group_trial}
- Average KV for each trial for each condition.

```{r vel_dyn_trial_all, echo = FALSE}
# Group mean
vel_dyn_trial_all <- aggregate(Mean~Condition*Skill*Subcomponent*TrialNr, data = vel_dyn_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_dyn_trial_all <- cbind(vel_dyn_trial_all[,1:4], as.data.frame(vel_dyn_trial_all[,5]))
# Change colnames
colnames(vel_dyn_trial_all) <- c("Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD", "SEM")
print(vel_dyn_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r vel_dyn_trial_all_line_forte, echo = FALSE}
p_vel_dyn_trial_all_forte <- ggplot(data = subset(vel_dyn_trial_all, vel_dyn_trial_all$Subcomponent == "Forte"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Dynamics/Forte") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_dyn_trial_all_forte
```

```{r vel_dyn_trial_all_line_piano, echo = FALSE}
p_vel_dyn_trial_all_piano <- ggplot(data = subset(vel_dyn_trial_all, vel_dyn_trial_all$Subcomponent == "Piano"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Dynamics/Piano") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_dyn_trial_all_piano
```

## Key Velocity Difference (KV-Diff) - Dynamics
### 1. All - individual{#vel_acc_dyn_ind_all}
- Average KV-Diff for each participant.

```{r vel_acc_dyn, echo = FALSE}
# For each individual
vel_acc_dyn <- aggregate(Acc~SubNr*Condition*Skill*Subcomponent, data = subset(df_vel_acc_dyn, df_vel_acc_dyn$Subcomponent == "FtoP" | df_vel_acc_dyn$Subcomponent == "PtoF"),
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_acc_dyn <- cbind(vel_acc_dyn[,1:4], as.data.frame(vel_acc_dyn[,5]))
# Change colnames
colnames(vel_acc_dyn) <- c("SubNr", "Condition", "Skill", "Subcomponent", "N", "Mean", "SD")
print(vel_acc_dyn)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean

```{r vel_acc_dyn_bar,  echo = FALSE}
p_vel_acc_dyn <- ggplot(data = vel_acc_dyn, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Subcomponent ~ .) +
  labs(y = "Difference", subtitle = "KV-Diff: Dynamics")
p_vel_acc_dyn
```

### 2. All - group{#vel_acc_dyn_group_all}
- Average KV-Diff for each condition.
- Hypothesis: Participants will make a larger contrast between forte and piano.

```{r vel_acc_dyn_all, echo = FALSE}
# Group mean
vel_acc_dyn_all <- aggregate(Mean~Condition*Skill*Subcomponent, data = vel_acc_dyn,
                         FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_acc_dyn_all <- cbind(vel_acc_dyn_all[,1:3], as.data.frame(vel_acc_dyn_all[,4]))
# Change colnames
colnames(vel_acc_dyn_all) <- c("Condition", "Skill", "Subcomponent", "N", "Mean", "SD", "SEM")
print(vel_acc_dyn_all)
```

```{r vel_acc_dyn_all_bar,  echo = FALSE}
p_vel_acc_dyn_all <- ggplot(data = vel_acc_dyn_all, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width = .2, position = position_dodge(.9)) +
  labs(y = "Difference", subtitle = "KV-Diff: Dynamics")
p_vel_acc_dyn_all
```

##### Box plot

```{r vel_acc_dyn_all_box, echo = FALSE}
p_vel_acc_dyn_all_box <- ggplot(data = vel_acc_dyn, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  labs(y = "Difference", subtitle = "KV-Diff: Dynamics")
p_vel_acc_dyn_all_box
```

#### Statistics (TBC)

### 3. Trial by trial - individual{#vel_acc_dyn_ind_trial}
- Average KV-Diff for each trial for each participant.

```{r vel_acc_dyn_trial, echo = FALSE}
# For each individual
vel_acc_dyn_trial <- aggregate(Acc~SubNr*Condition*Skill*Subcomponent*TrialNr, data = subset(df_vel_acc_dyn, df_vel_acc_dyn$Subcomponent == "FtoP" | df_vel_acc_dyn$Subcomponent == "PtoF"),
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_acc_dyn_trial <- cbind(vel_acc_dyn_trial[,1:5], as.data.frame(vel_acc_dyn_trial[,6]))
# Change colnames
colnames(vel_acc_dyn_trial) <- c("SubNr", "Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD")
print(vel_acc_dyn_trial)
```

#### Plot
##### Line graph
```{r vel_acc_dyn_trial_line_ftop, echo = FALSE, fig.height = 8}
p_vel_acc_dyn_trial_ftop <- ggplot(data = subset(vel_acc_dyn_trial, vel_acc_dyn_trial$Subcomponent == "FtoP"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Dynamics/Forte to Piano") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_dyn_trial_ftop
```

```{r vel_acc_dyn_trial_line_ptof, echo = FALSE, fig.height = 8}
p_vel_acc_dyn_trial_ptof <- ggplot(data = subset(vel_acc_dyn_trial, vel_acc_dyn_trial$Subcomponent == "PtoF"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Dynamics/Piano to Forte") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_dyn_trial_ptof
```

### 4. Trial by trial - group{#vel_acc_dyn_group_trial}
- Average KV-Diff for each trial for each condition.

```{r vel_acc_dyn_trial_all, echo = FALSE}
# Group mean
vel_acc_dyn_trial_all <- aggregate(Mean~Condition*Skill*Subcomponent*TrialNr, data = vel_acc_dyn_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_acc_dyn_trial_all <- cbind(vel_acc_dyn_trial_all[,1:4], as.data.frame(vel_acc_dyn_trial_all[,5]))
# Change colnames
colnames(vel_acc_dyn_trial_all) <- c("Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD", "SEM")
print(vel_acc_dyn_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r vel_acc_dyn_trial_all_line_ftop, echo = FALSE}
p_vel_acc_dyn_trial_all_ftop <- ggplot(data = subset(vel_acc_dyn_trial_all, vel_acc_dyn_trial_all$Subcomponent == "FtoP"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Dynamics/Forte to Piano") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_dyn_trial_all_ftop
```

```{r vel_acc_dyn_trial_all_line_ptof, echo = FALSE}
p_vel_acc_dyn_trial_all_ptof <- ggplot(data = subset(vel_acc_dyn_trial_all, vel_acc_dyn_trial_all$Subcomponent == "PtoF"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Dynamics/Piano to Forte") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_dyn_trial_all_ptof
```

###########
###########

## Key Velocity (KV) - Articulation
### 1. All - individual{#vel_art_ind_all}
- Average KV for each participant.

```{r vel_art, echo = FALSE}
# For each individual
vel_art <- aggregate(Velocity~SubNr*Condition*Skill*Subcomponent, data = df_vel_art,
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_art <- cbind(vel_art[,1:4], as.data.frame(vel_art[,5]))
# Change colnames
colnames(vel_art) <- c("SubNr", "Condition", "Skill", "Subcomponent", "N", "Mean", "SD")
print(vel_art)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean

```{r vel_art_bar,  echo = FALSE}
p_vel_art <- ggplot(data = vel_art, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Subcomponent ~ .) +
  labs(y = "KV (0-127)", subtitle = "KV: Articulation") + coord_cartesian(ylim = c(40, 100))
p_vel_art
```

### 2. All - group{#vel_art_group_all}
- Average KV for each condition.

```{r vel_art_all, echo = FALSE}
# Group mean
vel_art_all <- aggregate(Mean~Condition*Skill*Subcomponent, data = vel_art,
                         FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_art_all <- cbind(vel_art_all[,1:3], as.data.frame(vel_art_all[,4]))
# Change colnames
colnames(vel_art_all) <- c("Condition", "Skill", "Subcomponent", "N", "Mean", "SD", "SEM")
print(vel_art_all)
```

#### Plot
##### Bar chart
- Error bars show SEM of the mean

```{r vel_art_all_bar, echo = FALSE}　
p_vel_art_all <- ggplot(data = vel_art_all, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width = .2, position = position_dodge(.9)) +
  labs(y = "KV (0-127)", subtitle = "KV: Articulation") + coord_cartesian(ylim = c(40, 100))
p_vel_art_all
```

##### Box plot

```{r vel_art_all_box, echo = FALSE}
p_vel_art_all_box <- ggplot(data = vel_art, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  labs(y = "KV (0-127)", subtitle = "KV: Articulation")
p_vel_art_all_box
```

#### Statistics (TBC)

### 3. Trial by trial - individual{#vel_art_ind_trial}
- Average KV for each trial for each participant.

```{r vel_art_trial, echo = FALSE}
# For each individual
vel_art_trial <- aggregate(Velocity~SubNr*Condition*Skill*Subcomponent*TrialNr, data = df_vel_art,
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_art_trial <- cbind(vel_art_trial[,1:5], as.data.frame(vel_art_trial[,6]))
# Change colnames
colnames(vel_art_trial) <- c("SubNr", "Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD")
print(vel_art_trial)
```

#### Plot
##### Line graph
```{r vel_art_trial_line_legato, echo = FALSE, fig.height = 8}
p_vel_art_trial_legato <- ggplot(data = subset(vel_art_trial, vel_art_trial$Subcomponent == "Legato"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Articulation/Legato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_art_trial_legato
```

```{r vel_art_trial_line_piano, echo = FALSE, fig.height = 8}
p_vel_art_trial_staccato <- ggplot(data = subset(vel_art_trial, vel_art_trial$Subcomponent == "Staccato"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Articulation/Staccato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_art_trial_staccato
```

### 4. Trial by trial - group{#vel_art_group_trial}
- Average KV for each trial for each condition.

```{r vel_art_trial_all, echo = FALSE}
# Group mean
vel_art_trial_all <- aggregate(Mean~Condition*Skill*Subcomponent*TrialNr, data = vel_art_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_art_trial_all <- cbind(vel_art_trial_all[,1:4], as.data.frame(vel_art_trial_all[,5]))
# Change colnames
colnames(vel_art_trial_all) <- c("Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD", "SEM")
print(vel_art_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r vel_art_trial_all_line_legato, echo = FALSE}
p_vel_art_trial_all_legato <- ggplot(data = subset(vel_art_trial_all, vel_art_trial_all$Subcomponent == "Legato"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Articulation/Legato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_art_trial_all_legato
```

```{r vel_art_trial_all_line_staccato, echo = FALSE}
p_vel_art_trial_all_staccato <- ggplot(data = subset(vel_art_trial_all, vel_art_trial_all$Subcomponent == "Staccato"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "KV (0-127)", subtitle = "KV: Articulation/Staccato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_art_trial_all_staccato
```

## Key Velocity Difference (KV-Diff) - Articulation
### 1. All - individual{#vel_acc_art_ind_all}
- Average KV-Diff for each participant.

```{r vel_acc_art, echo = FALSE}
# For each individual
vel_acc_art <- aggregate(Acc~SubNr*Condition*Skill*Subcomponent, data = subset(df_vel_acc_art, df_vel_acc_art$Subcomponent == "LtoS" | df_vel_acc_art$Subcomponent == "StoL"),
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_acc_art <- cbind(vel_acc_art[,1:4], as.data.frame(vel_acc_art[,5]))
# Change colnames
colnames(vel_acc_art) <- c("SubNr", "Condition", "Skill", "Subcomponent", "N", "Mean", "SD")
print(vel_acc_art)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean

```{r vel_acc_art_bar,  echo = FALSE}
p_vel_acc_art <- ggplot(data = vel_acc_art, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Subcomponent ~ .) +
  labs(y = "Difference", subtitle = "KV-Diff: Articulaion")
p_vel_acc_art
```

### 2. All - group{#vel_acc_art_group_all}
- Average KV-Diff for each condition.

```{r vel_acc_art_all, echo = FALSE}
# Group mean
vel_acc_art_all <- aggregate(Mean~Condition*Skill*Subcomponent, data = vel_acc_art,
                         FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_acc_art_all <- cbind(vel_acc_art_all[,1:3], as.data.frame(vel_acc_art_all[,4]))
# Change colnames
colnames(vel_acc_art_all) <- c("Condition", "Skill", "Subcomponent", "N", "Mean", "SD", "SEM")
print(vel_acc_art_all)
```

##### Bar chart

```{r vel_acc_art_all_bar,  echo = FALSE}
p_vel_acc_art_all <- ggplot(data = vel_acc_art_all, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width = .2, position = position_dodge(.9)) +
  labs(y = "Difference", subtitle = "KV-Diff: Articulation")
p_vel_acc_art_all
```

##### Box plot

```{r vel_acc_art_all_box, echo = FALSE}
p_vel_acc_art_all_box <- ggplot(data = vel_acc_art, aes(x = Subcomponent, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  labs(y = "Difference", subtitle = "KV-Diff: Articulation")
p_vel_acc_art_all_box
```

##### Statistics

### 3. Trial by trial - individual{#kot_dyn_ind_trial}
- Average KV-Diff for each trial for each participant.

```{r vel_acc_art_trial, echo = FALSE}
# For each individual
vel_acc_art_trial <- aggregate(Acc~SubNr*Condition*Skill*Subcomponent*TrialNr, data = subset(df_vel_acc_art, df_vel_acc_art$Subcomponent == "LtoS" | df_vel_acc_art$Subcomponent == "StoL"),
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_acc_art_trial <- cbind(vel_acc_art_trial[,1:5], as.data.frame(vel_acc_art_trial[,6]))
# Change colnames
colnames(vel_acc_art_trial) <- c("SubNr", "Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD")
print(vel_acc_art_trial)
```


#### Plot
##### Line graph
```{r vel_acc_art_trial_line_ltos, echo = FALSE, fig.height = 8}
p_vel_acc_art_trial_ltos <- ggplot(data = subset(vel_acc_art_trial, vel_acc_art_trial$Subcomponent == "LtoS"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Articulation/Legato to Staccato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_art_trial_ltos
```

```{r vel_acc_art_trial_line_stol, echo = FALSE, fig.height = 8}
p_vel_acc_art_trial_stol <- ggplot(data = subset(vel_acc_art_trial, vel_acc_art_trial$Subcomponent == "StoL"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Articulation/Staccato to Legato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_art_trial_stol
```

### 4. Trial by trial - group{#vel_acc_art_group_trial}
- Average KV-Diff for each trial for each condition.

```{r vel_acc_art_trial_all, echo = FALSE}
# Group mean
vel_acc_art_trial_all <- aggregate(Mean~Condition*Skill*Subcomponent*TrialNr, data = vel_acc_art_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_acc_art_trial_all <- cbind(vel_acc_art_trial_all[,1:4], as.data.frame(vel_acc_art_trial_all[,5]))
# Change colnames
colnames(vel_acc_art_trial_all) <- c("Condition", "Skill", "Subcomponent", "TrialNr", "N", "Mean", "SD", "SEM")
print(vel_acc_art_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r vel_acc_art_trial_all_line_ltos, echo = FALSE}
p_vel_acc_art_trial_all_ltos <- ggplot(data = subset(vel_acc_art_trial_all, vel_acc_art_trial_all$Subcomponent == "LtoS"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Articulation/Legato to Staccato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_art_trial_all_ltos
```

```{r vel_acc_art_trial_all_line_stol, echo = FALSE}
p_vel_acc_art_trial_all_stol <- ggplot(data = subset(vel_acc_art_trial_all, vel_acc_art_trial_all$Subcomponent == "StoL"), aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "Difference", subtitle = "KV-Diff: Articulation/Legato to Staccato") + scale_x_continuous(breaks=seq(1,8,1))
p_vel_acc_art_trial_all_stol
```

## Sequence plot
#### Dynamics{#sequence_dyn}
```{r seq_dyn, fig.width = 15, fig.height = 5, echo = FALSE}
# Average vel_dynocity for each note
# For each participant
vel_dyn_seq <- aggregate(Velocity~SubNr*Condition*Skill*NoteNr, data = df_vel_dyn, 
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_dyn_seq <- cbind(vel_dyn_seq[,1:4], as.data.frame(vel_dyn_seq[,5]))
# Change colnames
colnames(vel_dyn_seq) <- c("SubNr", "Condition", "Skill", "Note", "N", "Mean", "SD")

# Group mean
vel_dyn_seq_stats <- aggregate(Mean~Condition*Skill*Note, data = vel_dyn_seq,
                           FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_dyn_seq_stats <- cbind(vel_dyn_seq_stats[,1:3], as.data.frame(vel_dyn_seq_stats[,4]))
# Change colnames
colnames(vel_dyn_seq_stats) <- c("Condition", "Skill", "Note", "N", "Mean", "SD", "SEM")

# Average acceleration for each note
# For each participant
vel_dyn_acc_seq <- aggregate(Acc~SubNr*Condition*Skill*Interval, data = df_vel_acc_dyn, 
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_dyn_acc_seq <- cbind(vel_dyn_acc_seq[,1:4], as.data.frame(vel_dyn_acc_seq[,5]))
# Change colnames
colnames(vel_dyn_acc_seq) <- c("SubNr", "Condition", "Skill", "Interval", "N", "Mean", "SD")

# Group mean
vel_dyn_acc_seq_stats <- aggregate(Mean~Condition*Skill*Interval, data = vel_dyn_acc_seq,
                           FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_dyn_acc_seq_stats <- cbind(vel_dyn_acc_seq_stats[,1:3], as.data.frame(vel_dyn_acc_seq_stats[,4]))
# Change colnames
colnames(vel_dyn_acc_seq_stats) <- c("Condition", "Skill", "Interval", "N", "Mean", "SD", "SEM")

p_vel_dyn_seq <- ggplot(data = vel_dyn_seq_stats, aes(x = Note, y = Mean, group = Condition, shape = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width=.2,
                position = position_dodge(0.05)) + 
  labs(y = "Velocity (0-127)") + scale_x_continuous(breaks=seq(1,67,1))
p_vel_dyn_seq

p_vel_dyn_acc_seq <- ggplot(data = vel_dyn_acc_seq_stats, aes(x = Interval, y = Mean, group = Condition, shape = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width=.2,
                position = position_dodge(.05)) + 
  labs(x = "Interval", y = "Difference") + scale_x_continuous(breaks=seq(1,66,1))
p_vel_dyn_acc_seq
```

#### Articulation{#sequence_art}
```{r seq_art, fig.width = 15, fig.height = 5, echo = FALSE}
# Average vel_artocity for each note
# For each participant
vel_art_seq <- aggregate(Velocity~SubNr*Condition*Skill*NoteNr, data = df_vel_art, 
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_art_seq <- cbind(vel_art_seq[,1:4], as.data.frame(vel_art_seq[,5]))
# Change colnames
colnames(vel_art_seq) <- c("SubNr", "Condition", "Skill", "Note", "N", "Mean", "SD")

# Group mean
vel_art_seq_stats <- aggregate(Mean~Condition*Skill*Note, data = vel_art_seq,
                           FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_art_seq_stats <- cbind(vel_art_seq_stats[,1:3], as.data.frame(vel_art_seq_stats[,4]))
# Change colnames
colnames(vel_art_seq_stats) <- c("Condition", "Skill", "Note", "N", "Mean", "SD", "SEM")

# Average acceleration for each note
# For each participant
vel_art_acc_seq <- aggregate(Acc~SubNr*Condition*Skill*Interval, data = df_vel_acc_art, 
                     FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
vel_art_acc_seq <- cbind(vel_art_acc_seq[,1:4], as.data.frame(vel_art_acc_seq[,5]))
# Change colnames
colnames(vel_art_acc_seq) <- c("SubNr", "Condition", "Skill", "Interval", "N", "Mean", "SD")

# Group mean
vel_art_acc_seq_stats <- aggregate(Mean~Condition*Skill*Interval, data = vel_art_acc_seq,
                           FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
vel_art_acc_seq_stats <- cbind(vel_art_acc_seq_stats[,1:3], as.data.frame(vel_art_acc_seq_stats[,4]))
# Change colnames
colnames(vel_art_acc_seq_stats) <- c("Condition", "Skill", "Interval", "N", "Mean", "SD", "SEM")

p_vel_art_seq <- ggplot(data = vel_art_seq_stats, aes(x = Note, y = Mean, group = Condition, shape = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width=.2,
                position = position_dodge(0.05)) + 
  labs(y = "Velocity (0-127)") + scale_x_continuous(breaks=seq(1,67,1))
p_vel_art_seq

p_vel_art_acc_seq <- ggplot(data = vel_art_acc_seq_stats, aes(x = Interval, y = Mean, group = Condition, shape = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width=.2,
                position = position_dodge(.05)) + 
  labs(x = "Interval", y = "Difference") + scale_x_continuous(breaks=seq(1,66,1))
p_vel_art_acc_seq
```
