---
title: 'IOIs Analysis: The Sound of Teaching Music 2'
output:
  html_notebook: default
editor_options: 
  chunk_output_type: inline
---

##### Description: This is a summary of all analyses for a tempo (IOIs).

## Experimental Design{#design}
- Independent variables: Condition (2 levels: teaching vs. performing) x Skill (2 levels: articulation vs. dynamics)
- Dependent variables: Interonset intervals, (**Not yet**: variability (SD/mean IOI))

### Main predictions
Participants will play slower while teaching regardless of the skills.

```{r setup, include = FALSE}
# packages
# data manipulation
if (!require("dplyr")) {install.packages("dplyr"); require("dplyr")}
# plot
if (!require("ggplot2")) {install.packages("ggplot2"); require("ggplot2")}
if (!require("ggsignif")) {install.packages("ggsignif"); require("ggsignif")}
# statistics
if (!require("stats")) {install.packages("stats"); require("stats")}
if (!require("effsize")) {install.packages("effsize"); require("effsize")}
if (!require("ez")) {install.packages("ez"); require("ez")}

# ggplots
theme_set(theme_classic())
theme_update(text = element_text(size = 20, family = "Helvetica Neue LT Std 57 Condensed"), legend.position = "bottom")
```

```{r extract, include = FALSE}
df_ioi <- read.csv("./trimmed/data_ioi.csv", header = T, sep = ",", dec = ".") # read a trimmed csv

# SubNr as a factor
df_ioi$SubNr <- as.factor(df_ioi$SubNr)

# Include only articulation
df_ioi_art <- df_ioi %>% dplyr::filter(Skill == "articulation")
# Include only dynamics
df_ioi_dyn <- df_ioi %>% dplyr::filter(Skill == "dynamics")

```

## IOI-Articulation 
### 1. All - individual{#art_ind_all}
- Average normIOIs for each participant.

```{r ioi_art, echo = FALSE}
# For each individual
ioi_art <- aggregate(normIOI~SubNr*Condition*Skill, data = df_ioi_art,
                 FUN = function(x){c(length(x), mean = mean(x), sd = sd(x))})
ioi_art <- cbind(ioi_art[,1:3], as.data.frame(ioi_art[,4]))
# Change colnames
colnames(ioi_art) <- c("SubNr", "Condition", "Skill", "N", "Mean", "SD")
print(ioi_art)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean
- A dashed line represents the ideal tempo

```{r ioi_art_bar,  echo = FALSE}
p_ioi_art <- ggplot(data = ioi_art, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation")
p_ioi_art
```

### 2. All - group{#art_group_all}
- Average normIOIs for each condition.
- Hypothesis: Participants will play slower when teaching.

```{r ioi_art_all, echo = FALSE}
# Group mean
ioi_art_all <- aggregate(Mean~Condition*Skill, data = ioi_art,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_art_all <- cbind(ioi_art_all[,1:2], as.data.frame(ioi_art_all[,3]))
# Change colnames
colnames(ioi_art_all) <- c("Condition", "Skill", "N", "Mean", "SD", "SEM")
print(ioi_art_all)
```

#### Plot
##### Bar chart
- Error bars show SEM of the mean
- A dashed line represents the ideal tempo

```{r ioi_art_all_bar, echo = FALSE}
p_ioi_art_all <- ggplot(data = ioi_art_all, aes(x = Condition, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width=.2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation") + coord_cartesian(ylim = c(.75, 1.1)) +
  theme(legend.position = "None")
p_ioi_art_all
```

##### Box plot
- A dashed line represents the ideal tempo

```{r ioi_art_all_box, echo = FALSE}
p_ioi_art_all_box <- ggplot(data = ioi_art, aes(x = Condition, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation") +
  theme(legend.position = "None")
p_ioi_art_all_box
```

#### Statistics (TBC)

### 3. Subcomponent change - individual{#art_ind_phrase}
- Compare normIOIs at which Subcomponent changes (e.g., Legato to Staccato) with others fir each participant.

```{r ioi_art_ch, echo = FALSE}
# Define subcomponent change
df_ioi_art$Change <- "No"
df_ioi_art$Change[df_ioi_art$Interval == 5 | df_ioi_art$Interval == 8 | df_ioi_art$Interval == 17 | df_ioi_art$Interval == 20 | df_ioi_art$Interval == 39 | df_ioi_art$Interval == 47] <- "Yes"

# For each individual
ioi_art_ch <- aggregate(normIOI~SubNr*Condition*Skill*Change, data = df_ioi_art,
                    FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
ioi_art_ch <- cbind(ioi_art_ch[,1:4], as.data.frame(ioi_art_ch[,5]))
# Change colnames
colnames(ioi_art_ch) <- c("SubNr", "Condition", "Skill", "Change", "N", "Mean", "SD")
print(ioi_art_ch)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean
- A dashed line represents the ideal tempo

```{r ioi_art_ch_bar, echo = FALSE}
p_ioi_art_ch <- ggplot(data = ioi_art_ch, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Change ~ .) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation")
p_ioi_art_ch
```

### 4. Subcomponent change - group{#art_group_phrase}
- Compare IOIs at which Subcomponent changes (e.g., Legato to Staccato) with others in the two conditions.
- Hypothesis: Participants will play more slowly where Subcomponent changes compared with other locations.

```{r ioi_art_ch_all, echo = FALSE}
# Group mean
ioi_art_ch_all <- aggregate(Mean~Condition*Skill*Change, data = ioi_art_ch,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_art_ch_all <- cbind(ioi_art_ch_all[,1:3], as.data.frame(ioi_art_ch_all[,4]))
# Change colnames
colnames(ioi_art_ch_all) <- c("Condition", "Skill", "Change", "N", "Mean", "SD", "SEM")
print(ioi_art_ch_all)
```

#### Plot
- Error bars show SEM of the mean
- A dashed line represents the ideal tempo

```{r ioi_art_ch_all_bar, echo = FALSE}
p_ioi_art_ch_all_bar <- ggplot(data = ioi_art_ch_all, aes(x = Change, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width=.2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation") + coord_cartesian(ylim = c(.75, 1.1))
p_ioi_art_ch_all_bar
```

##### Box plot
- A dashed line represents the ideal tempo

```{r ioi_art_ch_all_box, echo = FALSE}
p_ioi_art_ch_box <- ggplot(data = ioi_art_ch, aes(x = Change, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Articulation")
p_ioi_art_ch_box
```

#### Statistics (TBC)

### 5. Trial by trial - individual{#art_ind_trial}
- Average normIOIs for each trial for each participant.

```{r ioi_art_trial, echo = FALSE}
# For each individual
ioi_art_trial <- aggregate(normIOI~SubNr*Condition*Skill*TrialNr, data = df_ioi_art,
                    FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
ioi_art_trial <- cbind(ioi_art_trial[,1:4], as.data.frame(ioi_art_trial[,5]))
# Change colnames
colnames(ioi_art_trial) <- c("SubNr", "Condition", "Skill", "TrialNr", "N", "Mean", "SD")
print(ioi_art_trial)
```

#### Plot
##### Line graph
- A dashed line represents the ideal tempo

```{r ioi_art_trial_line, echo = FALSE, fig.height = 8}
p_ioi_art_trial <- ggplot(data = ioi_art_trial, aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Normalised IOI", subtitle = "IOI: Articulation") + scale_x_continuous(breaks=seq(1,8,1))
p_ioi_art_trial
```

### 6. Trial by trial - group{#art_group_trial}
- Average normIOIs for each trial for each condition.

```{r ioi_art_trial_all, echo = FALSE}
# Group mean
ioi_art_trial_all <- aggregate(Mean~Condition*Skill*TrialNr, data = ioi_art_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_art_trial_all <- cbind(ioi_art_trial_all[,1:3], as.data.frame(ioi_art_trial_all[,4]))
# Change colnames
colnames(ioi_art_trial_all) <- c("Condition", "Skill", "TrialNr", "N", "Mean", "SD", "SEM")
print(ioi_art_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r ioi_art_trial_all_line, echo = FALSE}
p_ioi_art_trial_all <- ggplot(data = ioi_art_trial_all, aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "Normalised IOI", subtitle = "IOI: Articulation") + scale_x_continuous(breaks=seq(1,8,1))
p_ioi_art_trial_all
```

###########
###########

## IOI-Dynamics
### 1. All - individual{#dyn_ind_all}
- Average normIOIs for each participant.

```{r ioi_dyn, echo = FALSE}
# For each individual
ioi_dyn <- aggregate(normIOI~SubNr*Condition*Skill, data = df_ioi_dyn,
                 FUN = function(x){c(length(x), mean = mean(x), sd = sd(x))})
ioi_dyn <- cbind(ioi_dyn[,1:3], as.data.frame(ioi_dyn[,4]))
# Change colnames
colnames(ioi_dyn) <- c("SubNr", "Condition", "Skill", "N", "Mean", "SD")
print(ioi_dyn)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean
- A dashed line represents the ideal tempo

```{r ioi_dyn_bar,  echo = FALSE}
p_ioi_dyn <- ggplot(data = ioi_dyn, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Dynamics")
p_ioi_dyn
```

### 2. All - group{#dyn_group_all}
- Average normIOIs for each condition.
- Hypothesis: Participants will play slower when teaching.

```{r ioi_dyn_all, echo = FALSE}
# Group mean
ioi_dyn_all <- aggregate(Mean~Condition*Skill, data = ioi_dyn,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_dyn_all <- cbind(ioi_dyn_all[,1:2], as.data.frame(ioi_dyn_all[,3]))
# Change colnames
colnames(ioi_dyn_all) <- c("Condition", "Skill", "N", "Mean", "SD", "SEM")
print(ioi_dyn_all)
```

#### Plot
##### Bar chart
- Error bars show SEM of the mean
- A dashed line represents the ideal tempo

```{r ioi_dyn_all_bar, echo = FALSE}
p_ioi_dyn_ch_all_bar <- ggplot(data = ioi_dyn_all, aes(x = Skill, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width=.2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo + 
  labs(y = "Normalised IOI", subtitle = "IOI: Dynamics") +  coord_cartesian(ylim = c(.75, 1.1))
p_ioi_dyn_ch_all_bar
```

##### Box plot
- A dashed line represents the tempo given by a metronome (80bpm)

```{r ioi_dyn_all_box, echo = FALSE}
p_ioi_dyn_all_box <- ggplot(data = ioi_dyn, aes(x = Condition, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Dynamics") + 
  theme(legend.position = "None")
p_ioi_dyn_all_box
```

#### Statistics (TBC)

### 3. Subcomponent changes - individual{#dyn_ind_phrase}
- Compare normIOIs at which Subcomponent changes (e.g., Forte to Piano) with others fir each participant.

```{r ioi_dyn_ch, echo = FALSE}
# Define phrase boundaries
df_ioi_dyn$Change <- "No"
df_ioi_dyn$Change[df_ioi_dyn$Interval == 5 | df_ioi_dyn$Interval == 8 | df_ioi_dyn$Interval == 17 | df_ioi_dyn$Interval == 20 | df_ioi_dyn$Interval == 39 | df_ioi_dyn$Interval == 47] <- "Yes"

# For each individual
ioi_dyn_ch <- aggregate(normIOI~SubNr*Condition*Skill*Change, data = df_ioi_dyn,
                    FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
ioi_dyn_ch <- cbind(ioi_dyn_ch[,1:4], as.data.frame(ioi_dyn_ch[,5]))
# Change colnames
colnames(ioi_dyn_ch) <- c("SubNr", "Condition", "Skill", "Change", "N", "Mean", "SD")
print(ioi_dyn_ch)
```

#### Plot
##### Bar chart
- Error bars show SD of the mean
- A dashed line represents the ideal tempo

```{r ioi_dyn_ch_bar, echo = FALSE}
p_ioi_dyn_ch <- ggplot(data = ioi_dyn_ch, aes(x = SubNr, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD),
                width = .2, position = position_dodge(.9)) +
  facet_grid(Change ~ .) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Dynamics")
p_ioi_dyn_ch
```

### 4. Subcomponent changes - group{#dyn_group_phrase}
- Compare IOIs at which Subcomponent changes with others in the two conditions.
- Hypothesis: Participants will play more slowly where Subcomponent changes compared with other locations.

```{r ioi_dyn_ch_all, echo = FALSE}
# Group mean
ioi_dyn_ch_all <- aggregate(Mean~Condition*Skill*Change, data = ioi_dyn_ch,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_dyn_ch_all <- cbind(ioi_dyn_ch_all[,1:3], as.data.frame(ioi_dyn_ch_all[,4]))
# Change colnames
colnames(ioi_dyn_ch_all) <- c("Condition", "Skill", "Change", "N", "Mean", "SD", "SEM")
print(ioi_dyn_ch_all)
```

#### Plot
##### Bar chart
- Error bars show SEM of the mean
- A dashed line represents the ideal tempo

```{r ioi_dyn_ch_all_bar, echo = FALSE}
p_ioi_dyn_ch_all_bar <- ggplot(data = ioi_dyn_ch_all, aes(x = Change, y = Mean, fill = Condition)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM),
                width=.2, position = position_dodge(.9)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "IOI: Dynamics") + coord_cartesian(ylim = c(.75, 1.1))
p_ioi_dyn_ch_all_bar
```

##### Box plot
- A dashed line represents the ideal tempo

```{r ioi_dyn_ch_all_box, echo = FALSE}
p_ioi_dyn_ch_box <- ggplot(data = ioi_dyn_ch, aes(x = Change, y = Mean, fill = Condition)) +
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 1, position = position_dodge(0.75)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  labs(y = "Normalised IOI", subtitle = "normIOI: Dynamics")
p_ioi_dyn_ch_box
```

#### Statistics (TBC)

### 5. Trial by trial - individual{#dyn_ind_trial}
- Average normIOIs for each trial for each participant.

```{r ioi_dyn_trial, echo = FALSE}
# For each individual
ioi_dyn_trial <- aggregate(normIOI~SubNr*Condition*Skill*TrialNr, data = df_ioi_dyn,
                    FUN = function(x){c(N = length(x), mean = mean(x), sd = sd(x))})
ioi_dyn_trial <- cbind(ioi_dyn_trial[,1:4], as.data.frame(ioi_dyn_trial[,5]))
# Change colnames
colnames(ioi_dyn_trial) <- c("SubNr", "Condition", "Skill", "TrialNr", "N", "Mean", "SD")
print(ioi_dyn_trial)
```

#### Plot
##### Line graph
- A dashed line represents the tempo given by a metronome (80bpm)

```{r ioi_dyn_trial_line, echo = FALSE, fig.height = 8}
p_ioi_dyn_trial <- ggplot(data = ioi_dyn_trial, aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line() +
  geom_point() +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  facet_wrap(SubNr ~ .) + 
  labs(x = "Trial", y = "Normalised IOI", subtitle = "IOI: Dynamics") + scale_x_continuous(breaks=seq(1,8,1))
p_ioi_dyn_trial
```

### 6. Trial by trial - group{#dyn_group_trial}
- Average normIOIs for each trial for each condition.

```{r ioi_dyn_trial_all, echo = FALSE}
# Group mean
ioi_dyn_trial_all <- aggregate(Mean~Condition*Skill*TrialNr, data = ioi_dyn_trial,
                       FUN = function(x){round(c(N = length(x), mean = mean(x), sd = sd(x), sem = sd(x)/sqrt(length(x))), 4)})
ioi_dyn_trial_all <- cbind(ioi_dyn_trial_all[,1:3], as.data.frame(ioi_dyn_trial_all[,4]))
# Change colnames
colnames(ioi_dyn_trial_all) <- c("Condition", "Skill", "TrialNr", "N", "Mean", "SD", "SEM")
print(ioi_dyn_trial_all)
```

#### Plot
##### Line graph
- Error bars show SEM of the mean

```{r ioi_dyn_trial_all_line, echo = FALSE}
p_ioi_dyn_trial_all <- ggplot(data = ioi_dyn_trial_all, aes(x = TrialNr, y = Mean, group = Condition, colour = Condition)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(position = position_dodge(.2)) +
  geom_hline(yintercept = 1, linetype = "dashed") + # Tempo
  geom_errorbar(aes(ymin = Mean - SEM, ymax = Mean + SEM), width = .2, position = position_dodge(.2)) + 
  labs(x = "Trial", y = "IOI (ms)", subtitle = "IOI: Dynamics") + scale_x_continuous(breaks=seq(1,8,1))
p_ioi_dyn_trial_all
```

